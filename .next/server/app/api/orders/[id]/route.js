"use strict";
/*
 * ATTENTION: An "eval-source-map" devtool has been used.
 * This devtool is neither made for production nor for readable output files.
 * It uses "eval()" calls to create a separate source file with attached SourceMaps in the browser devtools.
 * If you are trying to read the output file, select a different devtool (https://webpack.js.org/configuration/devtool/)
 * or disable the default devtool with "devtool: false".
 * If you are looking for production-ready output files, see mode: "production" (https://webpack.js.org/configuration/mode/).
 */
(() => {
var exports = {};
exports.id = "app/api/orders/[id]/route";
exports.ids = ["app/api/orders/[id]/route"];
exports.modules = {

/***/ "@prisma/client":
/*!*********************************!*\
  !*** external "@prisma/client" ***!
  \*********************************/
/***/ ((module) => {

module.exports = require("@prisma/client");

/***/ }),

/***/ "next/dist/compiled/next-server/app-route.runtime.dev.js":
/*!**************************************************************************!*\
  !*** external "next/dist/compiled/next-server/app-route.runtime.dev.js" ***!
  \**************************************************************************/
/***/ ((module) => {

module.exports = require("next/dist/compiled/next-server/app-route.runtime.dev.js");

/***/ }),

/***/ "buffer":
/*!*************************!*\
  !*** external "buffer" ***!
  \*************************/
/***/ ((module) => {

module.exports = require("buffer");

/***/ }),

/***/ "(rsc)/./node_modules/next/dist/build/webpack/loaders/next-app-loader.js?name=app%2Fapi%2Forders%2F%5Bid%5D%2Froute&page=%2Fapi%2Forders%2F%5Bid%5D%2Froute&appPaths=&pagePath=private-next-app-dir%2Fapi%2Forders%2F%5Bid%5D%2Froute.ts&appDir=D%3A%5Cmobile%5Capp&pageExtensions=tsx&pageExtensions=ts&pageExtensions=jsx&pageExtensions=js&rootDir=D%3A%5Cmobile&isDev=true&tsconfigPath=tsconfig.json&basePath=&assetPrefix=&nextConfigOutput=&preferredRegion=&middlewareConfig=e30%3D!":
/*!*********************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************!*\
  !*** ./node_modules/next/dist/build/webpack/loaders/next-app-loader.js?name=app%2Fapi%2Forders%2F%5Bid%5D%2Froute&page=%2Fapi%2Forders%2F%5Bid%5D%2Froute&appPaths=&pagePath=private-next-app-dir%2Fapi%2Forders%2F%5Bid%5D%2Froute.ts&appDir=D%3A%5Cmobile%5Capp&pageExtensions=tsx&pageExtensions=ts&pageExtensions=jsx&pageExtensions=js&rootDir=D%3A%5Cmobile&isDev=true&tsconfigPath=tsconfig.json&basePath=&assetPrefix=&nextConfigOutput=&preferredRegion=&middlewareConfig=e30%3D! ***!
  \*********************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   headerHooks: () => (/* binding */ headerHooks),\n/* harmony export */   originalPathname: () => (/* binding */ originalPathname),\n/* harmony export */   patchFetch: () => (/* binding */ patchFetch),\n/* harmony export */   requestAsyncStorage: () => (/* binding */ requestAsyncStorage),\n/* harmony export */   routeModule: () => (/* binding */ routeModule),\n/* harmony export */   serverHooks: () => (/* binding */ serverHooks),\n/* harmony export */   staticGenerationAsyncStorage: () => (/* binding */ staticGenerationAsyncStorage),\n/* harmony export */   staticGenerationBailout: () => (/* binding */ staticGenerationBailout)\n/* harmony export */ });\n/* harmony import */ var next_dist_server_future_route_modules_app_route_module_compiled__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! next/dist/server/future/route-modules/app-route/module.compiled */ \"(rsc)/./node_modules/next/dist/server/future/route-modules/app-route/module.compiled.js\");\n/* harmony import */ var next_dist_server_future_route_modules_app_route_module_compiled__WEBPACK_IMPORTED_MODULE_0___default = /*#__PURE__*/__webpack_require__.n(next_dist_server_future_route_modules_app_route_module_compiled__WEBPACK_IMPORTED_MODULE_0__);\n/* harmony import */ var next_dist_server_future_route_kind__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! next/dist/server/future/route-kind */ \"(rsc)/./node_modules/next/dist/server/future/route-kind.js\");\n/* harmony import */ var next_dist_server_lib_patch_fetch__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! next/dist/server/lib/patch-fetch */ \"(rsc)/./node_modules/next/dist/server/lib/patch-fetch.js\");\n/* harmony import */ var next_dist_server_lib_patch_fetch__WEBPACK_IMPORTED_MODULE_2___default = /*#__PURE__*/__webpack_require__.n(next_dist_server_lib_patch_fetch__WEBPACK_IMPORTED_MODULE_2__);\n/* harmony import */ var D_mobile_app_api_orders_id_route_ts__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ./app/api/orders/[id]/route.ts */ \"(rsc)/./app/api/orders/[id]/route.ts\");\n\n\n\n\n// We inject the nextConfigOutput here so that we can use them in the route\n// module.\nconst nextConfigOutput = \"\"\nconst routeModule = new next_dist_server_future_route_modules_app_route_module_compiled__WEBPACK_IMPORTED_MODULE_0__.AppRouteRouteModule({\n    definition: {\n        kind: next_dist_server_future_route_kind__WEBPACK_IMPORTED_MODULE_1__.RouteKind.APP_ROUTE,\n        page: \"/api/orders/[id]/route\",\n        pathname: \"/api/orders/[id]\",\n        filename: \"route\",\n        bundlePath: \"app/api/orders/[id]/route\"\n    },\n    resolvedPagePath: \"D:\\\\mobile\\\\app\\\\api\\\\orders\\\\[id]\\\\route.ts\",\n    nextConfigOutput,\n    userland: D_mobile_app_api_orders_id_route_ts__WEBPACK_IMPORTED_MODULE_3__\n});\n// Pull out the exports that we need to expose from the module. This should\n// be eliminated when we've moved the other routes to the new format. These\n// are used to hook into the route.\nconst { requestAsyncStorage, staticGenerationAsyncStorage, serverHooks, headerHooks, staticGenerationBailout } = routeModule;\nconst originalPathname = \"/api/orders/[id]/route\";\nfunction patchFetch() {\n    return (0,next_dist_server_lib_patch_fetch__WEBPACK_IMPORTED_MODULE_2__.patchFetch)({\n        serverHooks,\n        staticGenerationAsyncStorage\n    });\n}\n\n\n//# sourceMappingURL=app-route.js.map//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKHJzYykvLi9ub2RlX21vZHVsZXMvbmV4dC9kaXN0L2J1aWxkL3dlYnBhY2svbG9hZGVycy9uZXh0LWFwcC1sb2FkZXIuanM/bmFtZT1hcHAlMkZhcGklMkZvcmRlcnMlMkYlNUJpZCU1RCUyRnJvdXRlJnBhZ2U9JTJGYXBpJTJGb3JkZXJzJTJGJTVCaWQlNUQlMkZyb3V0ZSZhcHBQYXRocz0mcGFnZVBhdGg9cHJpdmF0ZS1uZXh0LWFwcC1kaXIlMkZhcGklMkZvcmRlcnMlMkYlNUJpZCU1RCUyRnJvdXRlLnRzJmFwcERpcj1EJTNBJTVDbW9iaWxlJTVDYXBwJnBhZ2VFeHRlbnNpb25zPXRzeCZwYWdlRXh0ZW5zaW9ucz10cyZwYWdlRXh0ZW5zaW9ucz1qc3gmcGFnZUV4dGVuc2lvbnM9anMmcm9vdERpcj1EJTNBJTVDbW9iaWxlJmlzRGV2PXRydWUmdHNjb25maWdQYXRoPXRzY29uZmlnLmpzb24mYmFzZVBhdGg9JmFzc2V0UHJlZml4PSZuZXh0Q29uZmlnT3V0cHV0PSZwcmVmZXJyZWRSZWdpb249Jm1pZGRsZXdhcmVDb25maWc9ZTMwJTNEISIsIm1hcHBpbmdzIjoiOzs7Ozs7Ozs7Ozs7Ozs7OztBQUFzRztBQUN2QztBQUNjO0FBQ0o7QUFDekU7QUFDQTtBQUNBO0FBQ0Esd0JBQXdCLGdIQUFtQjtBQUMzQztBQUNBLGNBQWMseUVBQVM7QUFDdkI7QUFDQTtBQUNBO0FBQ0E7QUFDQSxLQUFLO0FBQ0w7QUFDQTtBQUNBLFlBQVk7QUFDWixDQUFDO0FBQ0Q7QUFDQTtBQUNBO0FBQ0EsUUFBUSx1R0FBdUc7QUFDL0c7QUFDQTtBQUNBLFdBQVcsNEVBQVc7QUFDdEI7QUFDQTtBQUNBLEtBQUs7QUFDTDtBQUM2Sjs7QUFFN0oiLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly9wcm9kby1hZ2VuY3kvP2NjNTUiXSwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IHsgQXBwUm91dGVSb3V0ZU1vZHVsZSB9IGZyb20gXCJuZXh0L2Rpc3Qvc2VydmVyL2Z1dHVyZS9yb3V0ZS1tb2R1bGVzL2FwcC1yb3V0ZS9tb2R1bGUuY29tcGlsZWRcIjtcbmltcG9ydCB7IFJvdXRlS2luZCB9IGZyb20gXCJuZXh0L2Rpc3Qvc2VydmVyL2Z1dHVyZS9yb3V0ZS1raW5kXCI7XG5pbXBvcnQgeyBwYXRjaEZldGNoIGFzIF9wYXRjaEZldGNoIH0gZnJvbSBcIm5leHQvZGlzdC9zZXJ2ZXIvbGliL3BhdGNoLWZldGNoXCI7XG5pbXBvcnQgKiBhcyB1c2VybGFuZCBmcm9tIFwiRDpcXFxcbW9iaWxlXFxcXGFwcFxcXFxhcGlcXFxcb3JkZXJzXFxcXFtpZF1cXFxccm91dGUudHNcIjtcbi8vIFdlIGluamVjdCB0aGUgbmV4dENvbmZpZ091dHB1dCBoZXJlIHNvIHRoYXQgd2UgY2FuIHVzZSB0aGVtIGluIHRoZSByb3V0ZVxuLy8gbW9kdWxlLlxuY29uc3QgbmV4dENvbmZpZ091dHB1dCA9IFwiXCJcbmNvbnN0IHJvdXRlTW9kdWxlID0gbmV3IEFwcFJvdXRlUm91dGVNb2R1bGUoe1xuICAgIGRlZmluaXRpb246IHtcbiAgICAgICAga2luZDogUm91dGVLaW5kLkFQUF9ST1VURSxcbiAgICAgICAgcGFnZTogXCIvYXBpL29yZGVycy9baWRdL3JvdXRlXCIsXG4gICAgICAgIHBhdGhuYW1lOiBcIi9hcGkvb3JkZXJzL1tpZF1cIixcbiAgICAgICAgZmlsZW5hbWU6IFwicm91dGVcIixcbiAgICAgICAgYnVuZGxlUGF0aDogXCJhcHAvYXBpL29yZGVycy9baWRdL3JvdXRlXCJcbiAgICB9LFxuICAgIHJlc29sdmVkUGFnZVBhdGg6IFwiRDpcXFxcbW9iaWxlXFxcXGFwcFxcXFxhcGlcXFxcb3JkZXJzXFxcXFtpZF1cXFxccm91dGUudHNcIixcbiAgICBuZXh0Q29uZmlnT3V0cHV0LFxuICAgIHVzZXJsYW5kXG59KTtcbi8vIFB1bGwgb3V0IHRoZSBleHBvcnRzIHRoYXQgd2UgbmVlZCB0byBleHBvc2UgZnJvbSB0aGUgbW9kdWxlLiBUaGlzIHNob3VsZFxuLy8gYmUgZWxpbWluYXRlZCB3aGVuIHdlJ3ZlIG1vdmVkIHRoZSBvdGhlciByb3V0ZXMgdG8gdGhlIG5ldyBmb3JtYXQuIFRoZXNlXG4vLyBhcmUgdXNlZCB0byBob29rIGludG8gdGhlIHJvdXRlLlxuY29uc3QgeyByZXF1ZXN0QXN5bmNTdG9yYWdlLCBzdGF0aWNHZW5lcmF0aW9uQXN5bmNTdG9yYWdlLCBzZXJ2ZXJIb29rcywgaGVhZGVySG9va3MsIHN0YXRpY0dlbmVyYXRpb25CYWlsb3V0IH0gPSByb3V0ZU1vZHVsZTtcbmNvbnN0IG9yaWdpbmFsUGF0aG5hbWUgPSBcIi9hcGkvb3JkZXJzL1tpZF0vcm91dGVcIjtcbmZ1bmN0aW9uIHBhdGNoRmV0Y2goKSB7XG4gICAgcmV0dXJuIF9wYXRjaEZldGNoKHtcbiAgICAgICAgc2VydmVySG9va3MsXG4gICAgICAgIHN0YXRpY0dlbmVyYXRpb25Bc3luY1N0b3JhZ2VcbiAgICB9KTtcbn1cbmV4cG9ydCB7IHJvdXRlTW9kdWxlLCByZXF1ZXN0QXN5bmNTdG9yYWdlLCBzdGF0aWNHZW5lcmF0aW9uQXN5bmNTdG9yYWdlLCBzZXJ2ZXJIb29rcywgaGVhZGVySG9va3MsIHN0YXRpY0dlbmVyYXRpb25CYWlsb3V0LCBvcmlnaW5hbFBhdGhuYW1lLCBwYXRjaEZldGNoLCAgfTtcblxuLy8jIHNvdXJjZU1hcHBpbmdVUkw9YXBwLXJvdXRlLmpzLm1hcCJdLCJuYW1lcyI6W10sInNvdXJjZVJvb3QiOiIifQ==\n//# sourceURL=webpack-internal:///(rsc)/./node_modules/next/dist/build/webpack/loaders/next-app-loader.js?name=app%2Fapi%2Forders%2F%5Bid%5D%2Froute&page=%2Fapi%2Forders%2F%5Bid%5D%2Froute&appPaths=&pagePath=private-next-app-dir%2Fapi%2Forders%2F%5Bid%5D%2Froute.ts&appDir=D%3A%5Cmobile%5Capp&pageExtensions=tsx&pageExtensions=ts&pageExtensions=jsx&pageExtensions=js&rootDir=D%3A%5Cmobile&isDev=true&tsconfigPath=tsconfig.json&basePath=&assetPrefix=&nextConfigOutput=&preferredRegion=&middlewareConfig=e30%3D!\n");

/***/ }),

/***/ "(rsc)/./app/api/orders/[id]/route.ts":
/*!**************************************!*\
  !*** ./app/api/orders/[id]/route.ts ***!
  \**************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   DELETE: () => (/* binding */ DELETE),\n/* harmony export */   GET: () => (/* binding */ GET),\n/* harmony export */   PATCH: () => (/* binding */ PATCH)\n/* harmony export */ });\n/* harmony import */ var next_dist_server_web_exports_next_response__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! next/dist/server/web/exports/next-response */ \"(rsc)/./node_modules/next/dist/server/web/exports/next-response.js\");\n/* harmony import */ var _prisma_client__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! @prisma/client */ \"@prisma/client\");\n/* harmony import */ var _prisma_client__WEBPACK_IMPORTED_MODULE_1___default = /*#__PURE__*/__webpack_require__.n(_prisma_client__WEBPACK_IMPORTED_MODULE_1__);\n/* harmony import */ var _lib_serverUtils__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ../../../../lib/serverUtils */ \"(rsc)/./lib/serverUtils.ts\");\n/* harmony import */ var _lib_violationSystem__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ../../../../lib/violationSystem */ \"(rsc)/./lib/violationSystem.ts\");\n\n\n\n\nconst prisma = new _prisma_client__WEBPACK_IMPORTED_MODULE_1__.PrismaClient();\n// Получение детальной информации о заказе\nasync function GET(request, { params }) {\n    try {\n        const orderId = parseInt(params.id);\n        console.log(\"API: Fetching order with ID:\", orderId);\n        // Получаем текущего пользователя\n        const authHeader = request.headers.get(\"authorization\");\n        const userData = (0,_lib_serverUtils__WEBPACK_IMPORTED_MODULE_2__.getUserDataFromToken)(authHeader);\n        console.log(\"API: User data:\", {\n            id: userData.id,\n            role: userData.role,\n            name: userData.name\n        });\n        if (!userData) {\n            console.log(\"API: No user data\");\n            return next_dist_server_web_exports_next_response__WEBPACK_IMPORTED_MODULE_0__[\"default\"].json({\n                error: \"Unauthorized\"\n            }, {\n                status: 401\n            });\n        }\n        // Получаем заказ\n        const order = await prisma.order.findUnique({\n            where: {\n                id: orderId\n            },\n            include: {\n                category: true,\n                client: {\n                    select: {\n                        id: true,\n                        name: true,\n                        email: true,\n                        phone: true,\n                        clientRating: true,\n                        clientReviewsCount: true\n                    }\n                },\n                executor: {\n                    select: {\n                        id: true,\n                        name: true,\n                        email: true,\n                        phone: true\n                    }\n                }\n            }\n        });\n        if (!order) {\n            console.log(\"API: Order not found with ID:\", orderId);\n            return next_dist_server_web_exports_next_response__WEBPACK_IMPORTED_MODULE_0__[\"default\"].json({\n                error: \"Order not found\"\n            }, {\n                status: 404\n            });\n        }\n        console.log(\"API: Order found:\", {\n            id: order.id,\n            clientId: order.clientId,\n            executorId: order.executorId,\n            status: order.status\n        });\n        // Проверяем права доступа\n        if (userData.role === \"client\" && order.clientId !== userData.id) {\n            console.log(\"API: Access denied for client - order clientId:\", order.clientId, \"user id:\", userData.id);\n            return next_dist_server_web_exports_next_response__WEBPACK_IMPORTED_MODULE_0__[\"default\"].json({\n                error: \"Access denied\"\n            }, {\n                status: 403\n            });\n        }\n        if (userData.role === \"executor\") {\n            // Исполнитель может видеть заказы, которые он принял, или заказы без исполнителя (для принятия)\n            // Также может видеть заказы в своей категории для принятия\n            if (order.executorId && order.executorId !== userData.id) {\n                // Проверяем, работает ли исполнитель в этой категории\n                const executorProfile = await prisma.executorProfile.findUnique({\n                    where: {\n                        userId: userData.id\n                    }\n                });\n                if (!executorProfile || !executorProfile.categories.includes(order.categoryId)) {\n                    console.log(\"API: Access denied for executor - not working in this category\");\n                    return next_dist_server_web_exports_next_response__WEBPACK_IMPORTED_MODULE_0__[\"default\"].json({\n                        error: \"Access denied\"\n                    }, {\n                        status: 403\n                    });\n                }\n            }\n        }\n        console.log(\"API: Access granted, returning order\");\n        return next_dist_server_web_exports_next_response__WEBPACK_IMPORTED_MODULE_0__[\"default\"].json(order);\n    } catch (error) {\n        console.error(\"Error fetching order:\", error);\n        return next_dist_server_web_exports_next_response__WEBPACK_IMPORTED_MODULE_0__[\"default\"].json({\n            error: \"Internal server error\"\n        }, {\n            status: 500\n        });\n    }\n}\n// Обновление заказа (принятие исполнителем)\nasync function PATCH(request, { params }) {\n    try {\n        const orderId = parseInt(params.id);\n        const body = await request.json();\n        const { status, executorId } = body;\n        // Получаем текущего пользователя\n        const authHeader = request.headers.get(\"authorization\");\n        if (!authHeader) {\n            return next_dist_server_web_exports_next_response__WEBPACK_IMPORTED_MODULE_0__[\"default\"].json({\n                error: \"Unauthorized\"\n            }, {\n                status: 401\n            });\n        }\n        const userData = (0,_lib_serverUtils__WEBPACK_IMPORTED_MODULE_2__.getUserDataFromToken)(authHeader);\n        if (!userData) {\n            return next_dist_server_web_exports_next_response__WEBPACK_IMPORTED_MODULE_0__[\"default\"].json({\n                error: \"Unauthorized\"\n            }, {\n                status: 401\n            });\n        }\n        // Проверяем, что заказ существует\n        const existingOrder = await prisma.order.findUnique({\n            where: {\n                id: orderId\n            },\n            include: {\n                client: true,\n                category: true\n            }\n        });\n        if (!existingOrder) {\n            return next_dist_server_web_exports_next_response__WEBPACK_IMPORTED_MODULE_0__[\"default\"].json({\n                error: \"Order not found\"\n            }, {\n                status: 404\n            });\n        }\n        // Если исполнитель принимает заказ\n        if (status === \"confirmed\" && executorId) {\n            // Проверяем, что пользователь является исполнителем\n            if (userData.role !== \"executor\") {\n                return next_dist_server_web_exports_next_response__WEBPACK_IMPORTED_MODULE_0__[\"default\"].json({\n                    error: \"Only executors can accept orders\"\n                }, {\n                    status: 403\n                });\n            }\n            // Проверяем, не заблокирован ли исполнитель\n            const blockStatus = await _lib_violationSystem__WEBPACK_IMPORTED_MODULE_3__.ViolationSystem.isExecutorBlocked(userData.id);\n            if (blockStatus.isBlocked) {\n                return next_dist_server_web_exports_next_response__WEBPACK_IMPORTED_MODULE_0__[\"default\"].json({\n                    error: \"Исполнитель заблокирован\",\n                    reason: blockStatus.reason,\n                    blockEndDate: blockStatus.blockEndDate\n                }, {\n                    status: 403\n                });\n            }\n            // Проверяем, что у исполнителя есть активная подписка\n            const hasActiveSubscription = await prisma.subscription.findFirst({\n                where: {\n                    userId: userData.id,\n                    status: \"active\",\n                    endDate: {\n                        gte: new Date()\n                    }\n                }\n            });\n            if (!hasActiveSubscription) {\n                return next_dist_server_web_exports_next_response__WEBPACK_IMPORTED_MODULE_0__[\"default\"].json({\n                    error: \"Active subscription required to accept orders\",\n                    subscriptionRequired: true\n                }, {\n                    status: 403\n                });\n            }\n            // Проверяем, что заказ еще не принят\n            if (existingOrder.status !== \"pending\") {\n                return next_dist_server_web_exports_next_response__WEBPACK_IMPORTED_MODULE_0__[\"default\"].json({\n                    error: \"Order is already taken\"\n                }, {\n                    status: 400\n                });\n            }\n            // Проверяем, что исполнитель работает в этой категории\n            const executorProfile = await prisma.executorProfile.findUnique({\n                where: {\n                    userId: userData.id\n                }\n            });\n            if (!executorProfile || !executorProfile.categories.includes(existingOrder.categoryId)) {\n                return next_dist_server_web_exports_next_response__WEBPACK_IMPORTED_MODULE_0__[\"default\"].json({\n                    error: \"You cannot accept orders in this category\"\n                }, {\n                    status: 403\n                });\n            }\n            // Обновляем заказ\n            const updatedOrder = await prisma.order.update({\n                where: {\n                    id: orderId\n                },\n                data: {\n                    status: \"confirmed\",\n                    executorId: userData.id\n                },\n                include: {\n                    client: {\n                        select: {\n                            id: true,\n                            name: true,\n                            email: true\n                        }\n                    },\n                    executor: {\n                        select: {\n                            id: true,\n                            name: true,\n                            email: true\n                        }\n                    },\n                    category: true\n                }\n            });\n            // Создаем уведомление для клиента\n            await prisma.notification.create({\n                data: {\n                    userId: existingOrder.clientId,\n                    title: \"Заказ принят исполнителем\",\n                    message: `Исполнитель ${userData.name} принял ваш заказ \"${existingOrder.serviceDescription}\"`,\n                    type: \"order_accepted\"\n                }\n            });\n            return next_dist_server_web_exports_next_response__WEBPACK_IMPORTED_MODULE_0__[\"default\"].json({\n                message: \"Order accepted successfully\",\n                order: updatedOrder\n            });\n        }\n        // Если исполнитель завершает заказ\n        if (status === \"completed\" && userData.role === \"executor\" && userData.id === existingOrder.executorId) {\n            const updatedOrder = await prisma.order.update({\n                where: {\n                    id: orderId\n                },\n                data: {\n                    status: \"completed\",\n                    completedAt: new Date()\n                },\n                include: {\n                    client: {\n                        select: {\n                            id: true,\n                            name: true,\n                            email: true\n                        }\n                    },\n                    executor: {\n                        select: {\n                            id: true,\n                            name: true,\n                            email: true\n                        }\n                    },\n                    category: true\n                }\n            });\n            // Создаем уведомление для клиента\n            await prisma.notification.create({\n                data: {\n                    userId: existingOrder.clientId,\n                    title: \"Заказ выполнен\",\n                    message: `Исполнитель ${userData.name} завершил ваш заказ \"${existingOrder.serviceDescription}\"`,\n                    type: \"order_completed\"\n                }\n            });\n            // Обновляем статистику исполнителя\n            await prisma.executorProfile.update({\n                where: {\n                    userId: userData.id\n                },\n                data: {\n                    completedOrders: {\n                        increment: 1\n                    }\n                }\n            });\n            return next_dist_server_web_exports_next_response__WEBPACK_IMPORTED_MODULE_0__[\"default\"].json({\n                message: \"Order completed successfully\",\n                order: updatedOrder\n            });\n        }\n        // Если клиент обновляет заказ\n        if (userData.role === \"client\" && userData.id === existingOrder.clientId) {\n            const updatedOrder = await prisma.order.update({\n                where: {\n                    id: orderId\n                },\n                data: {\n                    status\n                },\n                include: {\n                    client: {\n                        select: {\n                            id: true,\n                            name: true,\n                            email: true\n                        }\n                    },\n                    executor: {\n                        select: {\n                            id: true,\n                            name: true,\n                            email: true\n                        }\n                    },\n                    category: true\n                }\n            });\n            return next_dist_server_web_exports_next_response__WEBPACK_IMPORTED_MODULE_0__[\"default\"].json({\n                message: \"Order updated successfully\",\n                order: updatedOrder\n            });\n        }\n        // Если исполнитель отклоняет заказ\n        if (status === \"cancelled\" && userData.role === \"executor\" && userData.id === existingOrder.executorId) {\n            const updatedOrder = await prisma.order.update({\n                where: {\n                    id: orderId\n                },\n                data: {\n                    status: \"cancelled\",\n                    cancelledAt: new Date()\n                },\n                include: {\n                    client: {\n                        select: {\n                            id: true,\n                            name: true,\n                            email: true\n                        }\n                    },\n                    executor: {\n                        select: {\n                            id: true,\n                            name: true,\n                            email: true\n                        }\n                    },\n                    category: true\n                }\n            });\n            // Создаем уведомление для клиента\n            await prisma.notification.create({\n                data: {\n                    userId: existingOrder.clientId,\n                    title: \"Заказ отклонен исполнителем\",\n                    message: `Исполнитель ${userData.name} отклонил ваш заказ \"${existingOrder.serviceDescription}\"`,\n                    type: \"order_rejected\"\n                }\n            });\n            return next_dist_server_web_exports_next_response__WEBPACK_IMPORTED_MODULE_0__[\"default\"].json({\n                message: \"Order rejected successfully\",\n                order: updatedOrder\n            });\n        }\n        return next_dist_server_web_exports_next_response__WEBPACK_IMPORTED_MODULE_0__[\"default\"].json({\n            error: \"Forbidden\"\n        }, {\n            status: 403\n        });\n    } catch (error) {\n        console.error(\"Error updating order:\", error);\n        return next_dist_server_web_exports_next_response__WEBPACK_IMPORTED_MODULE_0__[\"default\"].json({\n            error: \"Failed to update order\"\n        }, {\n            status: 500\n        });\n    }\n}\nasync function DELETE(request, { params }) {\n    try {\n        const orderId = parseInt(params.id);\n        // Проверяем, существует ли заказ\n        const existingOrder = await prisma.order.findUnique({\n            where: {\n                id: orderId\n            }\n        });\n        if (!existingOrder) {\n            return next_dist_server_web_exports_next_response__WEBPACK_IMPORTED_MODULE_0__[\"default\"].json({\n                error: \"Заказ не найден\"\n            }, {\n                status: 404\n            });\n        }\n        // Удаляем заказ\n        await prisma.order.delete({\n            where: {\n                id: orderId\n            }\n        });\n        // Обновляем счетчик заказов в категории\n        await prisma.category.update({\n            where: {\n                id: existingOrder.categoryId\n            },\n            data: {\n                orderCount: {\n                    decrement: 1\n                }\n            }\n        });\n        return next_dist_server_web_exports_next_response__WEBPACK_IMPORTED_MODULE_0__[\"default\"].json({\n            success: true,\n            message: \"Заказ успешно удален\"\n        });\n    } catch (error) {\n        console.error(\"Error deleting order:\", error);\n        return next_dist_server_web_exports_next_response__WEBPACK_IMPORTED_MODULE_0__[\"default\"].json({\n            error: \"Ошибка при удалении заказа\"\n        }, {\n            status: 500\n        });\n    }\n}\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,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TSxDQUFDO1lBQzNCakMsT0FBTztnQkFBRWQsSUFBSWlDLGNBQWNILFVBQVU7WUFBQztZQUN0Q2tCLE1BQU07Z0JBQ0phLFlBQVk7b0JBQ1ZDLFdBQVc7Z0JBQ2I7WUFDRjtRQUNGO1FBRUEsT0FBT3hFLGtGQUFZQSxDQUFDbUIsSUFBSSxDQUFDO1lBQ3ZCc0QsU0FBUztZQUNUWCxTQUFTO1FBQ1g7SUFDRixFQUFFLE9BQU8xQyxPQUFPO1FBQ2RULFFBQVFTLEtBQUssQ0FBQyx5QkFBeUJBO1FBQ3ZDLE9BQU9wQixrRkFBWUEsQ0FBQ21CLElBQUksQ0FDdEI7WUFBRUMsT0FBTztRQUE2QixHQUN0QztZQUFFQyxRQUFRO1FBQUk7SUFFbEI7QUFDRiIsInNvdXJjZXMiOlsid2VicGFjazovL3Byb2RvLWFnZW5jeS8uL2FwcC9hcGkvb3JkZXJzL1tpZF0vcm91dGUudHM/MmU5YyJdLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgeyBOZXh0UmVxdWVzdCwgTmV4dFJlc3BvbnNlIH0gZnJvbSAnbmV4dC9zZXJ2ZXInXG5pbXBvcnQgeyBQcmlzbWFDbGllbnQgfSBmcm9tICdAcHJpc21hL2NsaWVudCdcbmltcG9ydCB7IGdldFVzZXJEYXRhRnJvbVRva2VuIH0gZnJvbSAnLi4vLi4vLi4vLi4vbGliL3NlcnZlclV0aWxzJ1xuaW1wb3J0IHsgVmlvbGF0aW9uU3lzdGVtIH0gZnJvbSAnLi4vLi4vLi4vLi4vbGliL3Zpb2xhdGlvblN5c3RlbSdcblxuY29uc3QgcHJpc21hID0gbmV3IFByaXNtYUNsaWVudCgpXG5cbi8vINCf0L7Qu9GD0YfQtdC90LjQtSDQtNC10YLQsNC70YzQvdC+0Lkg0LjQvdGE0L7RgNC80LDRhtC40Lgg0L4g0LfQsNC60LDQt9C1XG5leHBvcnQgYXN5bmMgZnVuY3Rpb24gR0VUKFxuICByZXF1ZXN0OiBOZXh0UmVxdWVzdCxcbiAgeyBwYXJhbXMgfTogeyBwYXJhbXM6IHsgaWQ6IHN0cmluZyB9IH1cbikge1xuICB0cnkge1xuICAgIGNvbnN0IG9yZGVySWQgPSBwYXJzZUludChwYXJhbXMuaWQpXG4gICAgY29uc29sZS5sb2coJ0FQSTogRmV0Y2hpbmcgb3JkZXIgd2l0aCBJRDonLCBvcmRlcklkKVxuXG4gICAgLy8g0J/QvtC70YPRh9Cw0LXQvCDRgtC10LrRg9GJ0LXQs9C+INC/0L7Qu9GM0LfQvtCy0LDRgtC10LvRj1xuICAgIGNvbnN0IGF1dGhIZWFkZXIgPSByZXF1ZXN0LmhlYWRlcnMuZ2V0KCdhdXRob3JpemF0aW9uJylcbiAgICBjb25zdCB1c2VyRGF0YSA9IGdldFVzZXJEYXRhRnJvbVRva2VuKGF1dGhIZWFkZXIpXG4gICAgY29uc29sZS5sb2coJ0FQSTogVXNlciBkYXRhOicsIHsgaWQ6IHVzZXJEYXRhLmlkLCByb2xlOiB1c2VyRGF0YS5yb2xlLCBuYW1lOiB1c2VyRGF0YS5uYW1lIH0pXG5cbiAgICBpZiAoIXVzZXJEYXRhKSB7XG4gICAgICBjb25zb2xlLmxvZygnQVBJOiBObyB1c2VyIGRhdGEnKVxuICAgICAgcmV0dXJuIE5leHRSZXNwb25zZS5qc29uKHsgZXJyb3I6ICdVbmF1dGhvcml6ZWQnIH0sIHsgc3RhdHVzOiA0MDEgfSlcbiAgICB9XG5cbiAgICAvLyDQn9C+0LvRg9GH0LDQtdC8INC30LDQutCw0LdcbiAgICBjb25zdCBvcmRlciA9IGF3YWl0IHByaXNtYS5vcmRlci5maW5kVW5pcXVlKHtcbiAgICAgIHdoZXJlOiB7IGlkOiBvcmRlcklkIH0sXG4gICAgICBpbmNsdWRlOiB7XG4gICAgICAgIGNhdGVnb3J5OiB0cnVlLFxuICAgICAgICBjbGllbnQ6IHtcbiAgICAgICAgICBzZWxlY3Q6IHtcbiAgICAgICAgICAgIGlkOiB0cnVlLFxuICAgICAgICAgICAgbmFtZTogdHJ1ZSxcbiAgICAgICAgICAgIGVtYWlsOiB0cnVlLFxuICAgICAgICAgICAgcGhvbmU6IHRydWUsXG4gICAgICAgICAgICBjbGllbnRSYXRpbmc6IHRydWUsXG4gICAgICAgICAgICBjbGllbnRSZXZpZXdzQ291bnQ6IHRydWVcbiAgICAgICAgICB9XG4gICAgICAgIH0sXG4gICAgICAgIGV4ZWN1dG9yOiB7XG4gICAgICAgICAgc2VsZWN0OiB7XG4gICAgICAgICAgICBpZDogdHJ1ZSxcbiAgICAgICAgICAgIG5hbWU6IHRydWUsXG4gICAgICAgICAgICBlbWFpbDogdHJ1ZSxcbiAgICAgICAgICAgIHBob25lOiB0cnVlXG4gICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICB9XG4gICAgfSlcblxuICAgIGlmICghb3JkZXIpIHtcbiAgICAgIGNvbnNvbGUubG9nKCdBUEk6IE9yZGVyIG5vdCBmb3VuZCB3aXRoIElEOicsIG9yZGVySWQpXG4gICAgICByZXR1cm4gTmV4dFJlc3BvbnNlLmpzb24oeyBlcnJvcjogJ09yZGVyIG5vdCBmb3VuZCcgfSwgeyBzdGF0dXM6IDQwNCB9KVxuICAgIH1cblxuICAgIGNvbnNvbGUubG9nKCdBUEk6IE9yZGVyIGZvdW5kOicsIHsgXG4gICAgICBpZDogb3JkZXIuaWQsIFxuICAgICAgY2xpZW50SWQ6IG9yZGVyLmNsaWVudElkLCBcbiAgICAgIGV4ZWN1dG9ySWQ6IG9yZGVyLmV4ZWN1dG9ySWQsXG4gICAgICBzdGF0dXM6IG9yZGVyLnN0YXR1cyBcbiAgICB9KVxuXG4gICAgLy8g0J/RgNC+0LLQtdGA0Y/QtdC8INC/0YDQsNCy0LAg0LTQvtGB0YLRg9C/0LBcbiAgICBpZiAodXNlckRhdGEucm9sZSA9PT0gJ2NsaWVudCcgJiYgb3JkZXIuY2xpZW50SWQgIT09IHVzZXJEYXRhLmlkKSB7XG4gICAgICBjb25zb2xlLmxvZygnQVBJOiBBY2Nlc3MgZGVuaWVkIGZvciBjbGllbnQgLSBvcmRlciBjbGllbnRJZDonLCBvcmRlci5jbGllbnRJZCwgJ3VzZXIgaWQ6JywgdXNlckRhdGEuaWQpXG4gICAgICByZXR1cm4gTmV4dFJlc3BvbnNlLmpzb24oeyBlcnJvcjogJ0FjY2VzcyBkZW5pZWQnIH0sIHsgc3RhdHVzOiA0MDMgfSlcbiAgICB9XG5cbiAgICBpZiAodXNlckRhdGEucm9sZSA9PT0gJ2V4ZWN1dG9yJykge1xuICAgICAgLy8g0JjRgdC/0L7Qu9C90LjRgtC10LvRjCDQvNC+0LbQtdGCINCy0LjQtNC10YLRjCDQt9Cw0LrQsNC30YssINC60L7RgtC+0YDRi9C1INC+0L0g0L/RgNC40L3Rj9C7LCDQuNC70Lgg0LfQsNC60LDQt9GLINCx0LXQtyDQuNGB0L/QvtC70L3QuNGC0LXQu9GPICjQtNC70Y8g0L/RgNC40L3Rj9GC0LjRjylcbiAgICAgIC8vINCi0LDQutC20LUg0LzQvtC20LXRgiDQstC40LTQtdGC0Ywg0LfQsNC60LDQt9GLINCyINGB0LLQvtC10Lkg0LrQsNGC0LXQs9C+0YDQuNC4INC00LvRjyDQv9GA0LjQvdGP0YLQuNGPXG4gICAgICBpZiAob3JkZXIuZXhlY3V0b3JJZCAmJiBvcmRlci5leGVjdXRvcklkICE9PSB1c2VyRGF0YS5pZCkge1xuICAgICAgICAvLyDQn9GA0L7QstC10YDRj9C10LwsINGA0LDQsdC+0YLQsNC10YIg0LvQuCDQuNGB0L/QvtC70L3QuNGC0LXQu9GMINCyINGN0YLQvtC5INC60LDRgtC10LPQvtGA0LjQuFxuICAgICAgICBjb25zdCBleGVjdXRvclByb2ZpbGUgPSBhd2FpdCBwcmlzbWEuZXhlY3V0b3JQcm9maWxlLmZpbmRVbmlxdWUoe1xuICAgICAgICAgIHdoZXJlOiB7IHVzZXJJZDogdXNlckRhdGEuaWQgfVxuICAgICAgICB9KVxuICAgICAgICBcbiAgICAgICAgaWYgKCFleGVjdXRvclByb2ZpbGUgfHwgIWV4ZWN1dG9yUHJvZmlsZS5jYXRlZ29yaWVzLmluY2x1ZGVzKG9yZGVyLmNhdGVnb3J5SWQpKSB7XG4gICAgICAgICAgY29uc29sZS5sb2coJ0FQSTogQWNjZXNzIGRlbmllZCBmb3IgZXhlY3V0b3IgLSBub3Qgd29ya2luZyBpbiB0aGlzIGNhdGVnb3J5JylcbiAgICAgICAgICByZXR1cm4gTmV4dFJlc3BvbnNlLmpzb24oeyBlcnJvcjogJ0FjY2VzcyBkZW5pZWQnIH0sIHsgc3RhdHVzOiA0MDMgfSlcbiAgICAgICAgfVxuICAgICAgfVxuICAgIH1cblxuICAgIGNvbnNvbGUubG9nKCdBUEk6IEFjY2VzcyBncmFudGVkLCByZXR1cm5pbmcgb3JkZXInKVxuICAgIHJldHVybiBOZXh0UmVzcG9uc2UuanNvbihvcmRlcilcbiAgfSBjYXRjaCAoZXJyb3IpIHtcbiAgICBjb25zb2xlLmVycm9yKCdFcnJvciBmZXRjaGluZyBvcmRlcjonLCBlcnJvcilcbiAgICByZXR1cm4gTmV4dFJlc3BvbnNlLmpzb24oeyBlcnJvcjogJ0ludGVybmFsIHNlcnZlciBlcnJvcicgfSwgeyBzdGF0dXM6IDUwMCB9KVxuICB9XG59XG5cbi8vINCe0LHQvdC+0LLQu9C10L3QuNC1INC30LDQutCw0LfQsCAo0L/RgNC40L3Rj9GC0LjQtSDQuNGB0L/QvtC70L3QuNGC0LXQu9C10LwpXG5leHBvcnQgYXN5bmMgZnVuY3Rpb24gUEFUQ0goXG4gIHJlcXVlc3Q6IE5leHRSZXF1ZXN0LFxuICB7IHBhcmFtcyB9OiB7IHBhcmFtczogeyBpZDogc3RyaW5nIH0gfVxuKSB7XG4gIHRyeSB7XG4gICAgY29uc3Qgb3JkZXJJZCA9IHBhcnNlSW50KHBhcmFtcy5pZClcbiAgICBjb25zdCBib2R5ID0gYXdhaXQgcmVxdWVzdC5qc29uKClcbiAgICBjb25zdCB7IHN0YXR1cywgZXhlY3V0b3JJZCB9ID0gYm9keVxuXG4gICAgLy8g0J/QvtC70YPRh9Cw0LXQvCDRgtC10LrRg9GJ0LXQs9C+INC/0L7Qu9GM0LfQvtCy0LDRgtC10LvRj1xuICAgIGNvbnN0IGF1dGhIZWFkZXIgPSByZXF1ZXN0LmhlYWRlcnMuZ2V0KCdhdXRob3JpemF0aW9uJylcbiAgICBpZiAoIWF1dGhIZWFkZXIpIHtcbiAgICAgIHJldHVybiBOZXh0UmVzcG9uc2UuanNvbih7IGVycm9yOiAnVW5hdXRob3JpemVkJyB9LCB7IHN0YXR1czogNDAxIH0pXG4gICAgfVxuXG4gICAgY29uc3QgdXNlckRhdGEgPSBnZXRVc2VyRGF0YUZyb21Ub2tlbihhdXRoSGVhZGVyKVxuXG4gICAgaWYgKCF1c2VyRGF0YSkge1xuICAgICAgcmV0dXJuIE5leHRSZXNwb25zZS5qc29uKHsgZXJyb3I6ICdVbmF1dGhvcml6ZWQnIH0sIHsgc3RhdHVzOiA0MDEgfSlcbiAgICB9XG5cbiAgICAvLyDQn9GA0L7QstC10YDRj9C10LwsINGH0YLQviDQt9Cw0LrQsNC3INGB0YPRidC10YHRgtCy0YPQtdGCXG4gICAgY29uc3QgZXhpc3RpbmdPcmRlciA9IGF3YWl0IHByaXNtYS5vcmRlci5maW5kVW5pcXVlKHtcbiAgICAgIHdoZXJlOiB7IGlkOiBvcmRlcklkIH0sXG4gICAgICBpbmNsdWRlOiB7XG4gICAgICAgIGNsaWVudDogdHJ1ZSxcbiAgICAgICAgY2F0ZWdvcnk6IHRydWVcbiAgICAgIH1cbiAgICB9KVxuXG4gICAgaWYgKCFleGlzdGluZ09yZGVyKSB7XG4gICAgICByZXR1cm4gTmV4dFJlc3BvbnNlLmpzb24oeyBlcnJvcjogJ09yZGVyIG5vdCBmb3VuZCcgfSwgeyBzdGF0dXM6IDQwNCB9KVxuICAgIH1cblxuICAgIC8vINCV0YHQu9C4INC40YHQv9C+0LvQvdC40YLQtdC70Ywg0L/RgNC40L3QuNC80LDQtdGCINC30LDQutCw0LdcbiAgICBpZiAoc3RhdHVzID09PSAnY29uZmlybWVkJyAmJiBleGVjdXRvcklkKSB7XG4gICAgICAvLyDQn9GA0L7QstC10YDRj9C10LwsINGH0YLQviDQv9C+0LvRjNC30L7QstCw0YLQtdC70Ywg0Y/QstC70Y/QtdGC0YHRjyDQuNGB0L/QvtC70L3QuNGC0LXQu9C10LxcbiAgICAgIGlmICh1c2VyRGF0YS5yb2xlICE9PSAnZXhlY3V0b3InKSB7XG4gICAgICAgIHJldHVybiBOZXh0UmVzcG9uc2UuanNvbih7IGVycm9yOiAnT25seSBleGVjdXRvcnMgY2FuIGFjY2VwdCBvcmRlcnMnIH0sIHsgc3RhdHVzOiA0MDMgfSlcbiAgICAgIH1cblxuICAgICAgLy8g0J/RgNC+0LLQtdGA0Y/QtdC8LCDQvdC1INC30LDQsdC70L7QutC40YDQvtCy0LDQvSDQu9C4INC40YHQv9C+0LvQvdC40YLQtdC70YxcbiAgICAgIGNvbnN0IGJsb2NrU3RhdHVzID0gYXdhaXQgVmlvbGF0aW9uU3lzdGVtLmlzRXhlY3V0b3JCbG9ja2VkKHVzZXJEYXRhLmlkKVxuICAgICAgaWYgKGJsb2NrU3RhdHVzLmlzQmxvY2tlZCkge1xuICAgICAgICByZXR1cm4gTmV4dFJlc3BvbnNlLmpzb24oe1xuICAgICAgICAgIGVycm9yOiAn0JjRgdC/0L7Qu9C90LjRgtC10LvRjCDQt9Cw0LHQu9C+0LrQuNGA0L7QstCw0L0nLFxuICAgICAgICAgIHJlYXNvbjogYmxvY2tTdGF0dXMucmVhc29uLFxuICAgICAgICAgIGJsb2NrRW5kRGF0ZTogYmxvY2tTdGF0dXMuYmxvY2tFbmREYXRlXG4gICAgICAgIH0sIHsgc3RhdHVzOiA0MDMgfSlcbiAgICAgIH1cblxuICAgICAgLy8g0J/RgNC+0LLQtdGA0Y/QtdC8LCDRh9GC0L4g0YMg0LjRgdC/0L7Qu9C90LjRgtC10LvRjyDQtdGB0YLRjCDQsNC60YLQuNCy0L3QsNGPINC/0L7QtNC/0LjRgdC60LBcbiAgICAgIGNvbnN0IGhhc0FjdGl2ZVN1YnNjcmlwdGlvbiA9IGF3YWl0IHByaXNtYS5zdWJzY3JpcHRpb24uZmluZEZpcnN0KHtcbiAgICAgICAgd2hlcmU6IHtcbiAgICAgICAgICB1c2VySWQ6IHVzZXJEYXRhLmlkLFxuICAgICAgICAgIHN0YXR1czogJ2FjdGl2ZScsXG4gICAgICAgICAgZW5kRGF0ZToge1xuICAgICAgICAgICAgZ3RlOiBuZXcgRGF0ZSgpXG4gICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICB9KVxuXG4gICAgICBpZiAoIWhhc0FjdGl2ZVN1YnNjcmlwdGlvbikge1xuICAgICAgICByZXR1cm4gTmV4dFJlc3BvbnNlLmpzb24oe1xuICAgICAgICAgIGVycm9yOiAnQWN0aXZlIHN1YnNjcmlwdGlvbiByZXF1aXJlZCB0byBhY2NlcHQgb3JkZXJzJyxcbiAgICAgICAgICBzdWJzY3JpcHRpb25SZXF1aXJlZDogdHJ1ZVxuICAgICAgICB9LCB7IHN0YXR1czogNDAzIH0pXG4gICAgICB9XG5cbiAgICAgIC8vINCf0YDQvtCy0LXRgNGP0LXQvCwg0YfRgtC+INC30LDQutCw0Lcg0LXRidC1INC90LUg0L/RgNC40L3Rj9GCXG4gICAgICBpZiAoZXhpc3RpbmdPcmRlci5zdGF0dXMgIT09ICdwZW5kaW5nJykge1xuICAgICAgICByZXR1cm4gTmV4dFJlc3BvbnNlLmpzb24oeyBlcnJvcjogJ09yZGVyIGlzIGFscmVhZHkgdGFrZW4nIH0sIHsgc3RhdHVzOiA0MDAgfSlcbiAgICAgIH1cblxuICAgICAgLy8g0J/RgNC+0LLQtdGA0Y/QtdC8LCDRh9GC0L4g0LjRgdC/0L7Qu9C90LjRgtC10LvRjCDRgNCw0LHQvtGC0LDQtdGCINCyINGN0YLQvtC5INC60LDRgtC10LPQvtGA0LjQuFxuICAgICAgY29uc3QgZXhlY3V0b3JQcm9maWxlID0gYXdhaXQgcHJpc21hLmV4ZWN1dG9yUHJvZmlsZS5maW5kVW5pcXVlKHtcbiAgICAgICAgd2hlcmU6IHsgdXNlcklkOiB1c2VyRGF0YS5pZCB9XG4gICAgICB9KVxuXG4gICAgICBpZiAoIWV4ZWN1dG9yUHJvZmlsZSB8fCAhZXhlY3V0b3JQcm9maWxlLmNhdGVnb3JpZXMuaW5jbHVkZXMoZXhpc3RpbmdPcmRlci5jYXRlZ29yeUlkKSkge1xuICAgICAgICByZXR1cm4gTmV4dFJlc3BvbnNlLmpzb24oeyBlcnJvcjogJ1lvdSBjYW5ub3QgYWNjZXB0IG9yZGVycyBpbiB0aGlzIGNhdGVnb3J5JyB9LCB7IHN0YXR1czogNDAzIH0pXG4gICAgICB9XG5cbiAgICAgIC8vINCe0LHQvdC+0LLQu9GP0LXQvCDQt9Cw0LrQsNC3XG4gICAgICBjb25zdCB1cGRhdGVkT3JkZXIgPSBhd2FpdCBwcmlzbWEub3JkZXIudXBkYXRlKHtcbiAgICAgICAgd2hlcmU6IHsgaWQ6IG9yZGVySWQgfSxcbiAgICAgICAgZGF0YToge1xuICAgICAgICAgIHN0YXR1czogJ2NvbmZpcm1lZCcsXG4gICAgICAgICAgZXhlY3V0b3JJZDogdXNlckRhdGEuaWRcbiAgICAgICAgfSxcbiAgICAgICAgaW5jbHVkZToge1xuICAgICAgICAgIGNsaWVudDoge1xuICAgICAgICAgICAgc2VsZWN0OiB7XG4gICAgICAgICAgICAgIGlkOiB0cnVlLFxuICAgICAgICAgICAgICBuYW1lOiB0cnVlLFxuICAgICAgICAgICAgICBlbWFpbDogdHJ1ZVxuICAgICAgICAgICAgfVxuICAgICAgICAgIH0sXG4gICAgICAgICAgZXhlY3V0b3I6IHtcbiAgICAgICAgICAgIHNlbGVjdDoge1xuICAgICAgICAgICAgICBpZDogdHJ1ZSxcbiAgICAgICAgICAgICAgbmFtZTogdHJ1ZSxcbiAgICAgICAgICAgICAgZW1haWw6IHRydWVcbiAgICAgICAgICAgIH1cbiAgICAgICAgICB9LFxuICAgICAgICAgIGNhdGVnb3J5OiB0cnVlXG4gICAgICAgIH1cbiAgICAgIH0pXG5cbiAgICAgIC8vINCh0L7Qt9C00LDQtdC8INGD0LLQtdC00L7QvNC70LXQvdC40LUg0LTQu9GPINC60LvQuNC10L3RgtCwXG4gICAgICBhd2FpdCBwcmlzbWEubm90aWZpY2F0aW9uLmNyZWF0ZSh7XG4gICAgICAgIGRhdGE6IHtcbiAgICAgICAgICB1c2VySWQ6IGV4aXN0aW5nT3JkZXIuY2xpZW50SWQsXG4gICAgICAgICAgdGl0bGU6ICfQl9Cw0LrQsNC3INC/0YDQuNC90Y/RgiDQuNGB0L/QvtC70L3QuNGC0LXQu9C10LwnLFxuICAgICAgICAgIG1lc3NhZ2U6IGDQmNGB0L/QvtC70L3QuNGC0LXQu9GMICR7dXNlckRhdGEubmFtZX0g0L/RgNC40L3Rj9C7INCy0LDRiCDQt9Cw0LrQsNC3IFwiJHtleGlzdGluZ09yZGVyLnNlcnZpY2VEZXNjcmlwdGlvbn1cImAsXG4gICAgICAgICAgdHlwZTogJ29yZGVyX2FjY2VwdGVkJ1xuICAgICAgICB9XG4gICAgICB9KVxuXG4gICAgICByZXR1cm4gTmV4dFJlc3BvbnNlLmpzb24oe1xuICAgICAgICBtZXNzYWdlOiAnT3JkZXIgYWNjZXB0ZWQgc3VjY2Vzc2Z1bGx5JyxcbiAgICAgICAgb3JkZXI6IHVwZGF0ZWRPcmRlclxuICAgICAgfSlcbiAgICB9XG5cbiAgICAvLyDQldGB0LvQuCDQuNGB0L/QvtC70L3QuNGC0LXQu9GMINC30LDQstC10YDRiNCw0LXRgiDQt9Cw0LrQsNC3XG4gICAgaWYgKHN0YXR1cyA9PT0gJ2NvbXBsZXRlZCcgJiYgdXNlckRhdGEucm9sZSA9PT0gJ2V4ZWN1dG9yJyAmJiB1c2VyRGF0YS5pZCA9PT0gZXhpc3RpbmdPcmRlci5leGVjdXRvcklkKSB7XG4gICAgICBjb25zdCB1cGRhdGVkT3JkZXIgPSBhd2FpdCBwcmlzbWEub3JkZXIudXBkYXRlKHtcbiAgICAgICAgd2hlcmU6IHsgaWQ6IG9yZGVySWQgfSxcbiAgICAgICAgZGF0YTogeyBcbiAgICAgICAgICBzdGF0dXM6ICdjb21wbGV0ZWQnLFxuICAgICAgICAgIGNvbXBsZXRlZEF0OiBuZXcgRGF0ZSgpXG4gICAgICAgIH0sXG4gICAgICAgIGluY2x1ZGU6IHtcbiAgICAgICAgICBjbGllbnQ6IHtcbiAgICAgICAgICAgIHNlbGVjdDoge1xuICAgICAgICAgICAgICBpZDogdHJ1ZSxcbiAgICAgICAgICAgICAgbmFtZTogdHJ1ZSxcbiAgICAgICAgICAgICAgZW1haWw6IHRydWVcbiAgICAgICAgICAgIH1cbiAgICAgICAgICB9LFxuICAgICAgICAgIGV4ZWN1dG9yOiB7XG4gICAgICAgICAgICBzZWxlY3Q6IHtcbiAgICAgICAgICAgICAgaWQ6IHRydWUsXG4gICAgICAgICAgICAgIG5hbWU6IHRydWUsXG4gICAgICAgICAgICAgIGVtYWlsOiB0cnVlXG4gICAgICAgICAgICB9XG4gICAgICAgICAgfSxcbiAgICAgICAgICBjYXRlZ29yeTogdHJ1ZVxuICAgICAgICB9XG4gICAgICB9KVxuXG4gICAgICAvLyDQodC+0LfQtNCw0LXQvCDRg9Cy0LXQtNC+0LzQu9C10L3QuNC1INC00LvRjyDQutC70LjQtdC90YLQsFxuICAgICAgYXdhaXQgcHJpc21hLm5vdGlmaWNhdGlvbi5jcmVhdGUoe1xuICAgICAgICBkYXRhOiB7XG4gICAgICAgICAgdXNlcklkOiBleGlzdGluZ09yZGVyLmNsaWVudElkLFxuICAgICAgICAgIHRpdGxlOiAn0JfQsNC60LDQtyDQstGL0L/QvtC70L3QtdC9JyxcbiAgICAgICAgICBtZXNzYWdlOiBg0JjRgdC/0L7Qu9C90LjRgtC10LvRjCAke3VzZXJEYXRhLm5hbWV9INC30LDQstC10YDRiNC40Lsg0LLQsNGIINC30LDQutCw0LcgXCIke2V4aXN0aW5nT3JkZXIuc2VydmljZURlc2NyaXB0aW9ufVwiYCxcbiAgICAgICAgICB0eXBlOiAnb3JkZXJfY29tcGxldGVkJ1xuICAgICAgICB9XG4gICAgICB9KVxuXG4gICAgICAvLyDQntCx0L3QvtCy0LvRj9C10Lwg0YHRgtCw0YLQuNGB0YLQuNC60YMg0LjRgdC/0L7Qu9C90LjRgtC10LvRj1xuICAgICAgYXdhaXQgcHJpc21hLmV4ZWN1dG9yUHJvZmlsZS51cGRhdGUoe1xuICAgICAgICB3aGVyZTogeyB1c2VySWQ6IHVzZXJEYXRhLmlkIH0sXG4gICAgICAgIGRhdGE6IHtcbiAgICAgICAgICBjb21wbGV0ZWRPcmRlcnM6IHtcbiAgICAgICAgICAgIGluY3JlbWVudDogMVxuICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgfSlcblxuICAgICAgcmV0dXJuIE5leHRSZXNwb25zZS5qc29uKHtcbiAgICAgICAgbWVzc2FnZTogJ09yZGVyIGNvbXBsZXRlZCBzdWNjZXNzZnVsbHknLFxuICAgICAgICBvcmRlcjogdXBkYXRlZE9yZGVyXG4gICAgICB9KVxuICAgIH1cblxuICAgIC8vINCV0YHQu9C4INC60LvQuNC10L3RgiDQvtCx0L3QvtCy0LvRj9C10YIg0LfQsNC60LDQt1xuICAgIGlmICh1c2VyRGF0YS5yb2xlID09PSAnY2xpZW50JyAmJiB1c2VyRGF0YS5pZCA9PT0gZXhpc3RpbmdPcmRlci5jbGllbnRJZCkge1xuICAgICAgY29uc3QgdXBkYXRlZE9yZGVyID0gYXdhaXQgcHJpc21hLm9yZGVyLnVwZGF0ZSh7XG4gICAgICAgIHdoZXJlOiB7IGlkOiBvcmRlcklkIH0sXG4gICAgICAgIGRhdGE6IHsgc3RhdHVzIH0sXG4gICAgICAgIGluY2x1ZGU6IHtcbiAgICAgICAgICBjbGllbnQ6IHtcbiAgICAgICAgICAgIHNlbGVjdDoge1xuICAgICAgICAgICAgICBpZDogdHJ1ZSxcbiAgICAgICAgICAgICAgbmFtZTogdHJ1ZSxcbiAgICAgICAgICAgICAgZW1haWw6IHRydWVcbiAgICAgICAgICAgIH1cbiAgICAgICAgICB9LFxuICAgICAgICAgIGV4ZWN1dG9yOiB7XG4gICAgICAgICAgICBzZWxlY3Q6IHtcbiAgICAgICAgICAgICAgaWQ6IHRydWUsXG4gICAgICAgICAgICAgIG5hbWU6IHRydWUsXG4gICAgICAgICAgICAgIGVtYWlsOiB0cnVlXG4gICAgICAgICAgICB9XG4gICAgICAgICAgfSxcbiAgICAgICAgICBjYXRlZ29yeTogdHJ1ZVxuICAgICAgICB9XG4gICAgICB9KVxuXG4gICAgICByZXR1cm4gTmV4dFJlc3BvbnNlLmpzb24oe1xuICAgICAgICBtZXNzYWdlOiAnT3JkZXIgdXBkYXRlZCBzdWNjZXNzZnVsbHknLFxuICAgICAgICBvcmRlcjogdXBkYXRlZE9yZGVyXG4gICAgICB9KVxuICAgIH1cblxuICAgIC8vINCV0YHQu9C4INC40YHQv9C+0LvQvdC40YLQtdC70Ywg0L7RgtC60LvQvtC90Y/QtdGCINC30LDQutCw0LdcbiAgICBpZiAoc3RhdHVzID09PSAnY2FuY2VsbGVkJyAmJiB1c2VyRGF0YS5yb2xlID09PSAnZXhlY3V0b3InICYmIHVzZXJEYXRhLmlkID09PSBleGlzdGluZ09yZGVyLmV4ZWN1dG9ySWQpIHtcbiAgICAgIGNvbnN0IHVwZGF0ZWRPcmRlciA9IGF3YWl0IHByaXNtYS5vcmRlci51cGRhdGUoe1xuICAgICAgICB3aGVyZTogeyBpZDogb3JkZXJJZCB9LFxuICAgICAgICBkYXRhOiB7IFxuICAgICAgICAgIHN0YXR1czogJ2NhbmNlbGxlZCcsXG4gICAgICAgICAgY2FuY2VsbGVkQXQ6IG5ldyBEYXRlKClcbiAgICAgICAgfSxcbiAgICAgICAgaW5jbHVkZToge1xuICAgICAgICAgIGNsaWVudDoge1xuICAgICAgICAgICAgc2VsZWN0OiB7XG4gICAgICAgICAgICAgIGlkOiB0cnVlLFxuICAgICAgICAgICAgICBuYW1lOiB0cnVlLFxuICAgICAgICAgICAgICBlbWFpbDogdHJ1ZVxuICAgICAgICAgICAgfVxuICAgICAgICAgIH0sXG4gICAgICAgICAgZXhlY3V0b3I6IHtcbiAgICAgICAgICAgIHNlbGVjdDoge1xuICAgICAgICAgICAgICBpZDogdHJ1ZSxcbiAgICAgICAgICAgICAgbmFtZTogdHJ1ZSxcbiAgICAgICAgICAgICAgZW1haWw6IHRydWVcbiAgICAgICAgICAgIH1cbiAgICAgICAgICB9LFxuICAgICAgICAgIGNhdGVnb3J5OiB0cnVlXG4gICAgICAgIH1cbiAgICAgIH0pXG5cbiAgICAgIC8vINCh0L7Qt9C00LDQtdC8INGD0LLQtdC00L7QvNC70LXQvdC40LUg0LTQu9GPINC60LvQuNC10L3RgtCwXG4gICAgICBhd2FpdCBwcmlzbWEubm90aWZpY2F0aW9uLmNyZWF0ZSh7XG4gICAgICAgIGRhdGE6IHtcbiAgICAgICAgICB1c2VySWQ6IGV4aXN0aW5nT3JkZXIuY2xpZW50SWQsXG4gICAgICAgICAgdGl0bGU6ICfQl9Cw0LrQsNC3INC+0YLQutC70L7QvdC10L0g0LjRgdC/0L7Qu9C90LjRgtC10LvQtdC8JyxcbiAgICAgICAgICBtZXNzYWdlOiBg0JjRgdC/0L7Qu9C90LjRgtC10LvRjCAke3VzZXJEYXRhLm5hbWV9INC+0YLQutC70L7QvdC40Lsg0LLQsNGIINC30LDQutCw0LcgXCIke2V4aXN0aW5nT3JkZXIuc2VydmljZURlc2NyaXB0aW9ufVwiYCxcbiAgICAgICAgICB0eXBlOiAnb3JkZXJfcmVqZWN0ZWQnXG4gICAgICAgIH1cbiAgICAgIH0pXG5cbiAgICAgIHJldHVybiBOZXh0UmVzcG9uc2UuanNvbih7XG4gICAgICAgIG1lc3NhZ2U6ICdPcmRlciByZWplY3RlZCBzdWNjZXNzZnVsbHknLFxuICAgICAgICBvcmRlcjogdXBkYXRlZE9yZGVyXG4gICAgICB9KVxuICAgIH1cblxuICAgIHJldHVybiBOZXh0UmVzcG9uc2UuanNvbih7IGVycm9yOiAnRm9yYmlkZGVuJyB9LCB7IHN0YXR1czogNDAzIH0pXG5cbiAgfSBjYXRjaCAoZXJyb3IpIHtcbiAgICBjb25zb2xlLmVycm9yKCdFcnJvciB1cGRhdGluZyBvcmRlcjonLCBlcnJvcilcbiAgICByZXR1cm4gTmV4dFJlc3BvbnNlLmpzb24oXG4gICAgICB7IGVycm9yOiAnRmFpbGVkIHRvIHVwZGF0ZSBvcmRlcicgfSxcbiAgICAgIHsgc3RhdHVzOiA1MDAgfVxuICAgIClcbiAgfVxufVxuXG5cblxuZXhwb3J0IGFzeW5jIGZ1bmN0aW9uIERFTEVURShcbiAgcmVxdWVzdDogUmVxdWVzdCxcbiAgeyBwYXJhbXMgfTogeyBwYXJhbXM6IHsgaWQ6IHN0cmluZyB9IH1cbikge1xuICB0cnkge1xuICAgIGNvbnN0IG9yZGVySWQgPSBwYXJzZUludChwYXJhbXMuaWQpXG5cbiAgICAvLyDQn9GA0L7QstC10YDRj9C10LwsINGB0YPRidC10YHRgtCy0YPQtdGCINC70Lgg0LfQsNC60LDQt1xuICAgIGNvbnN0IGV4aXN0aW5nT3JkZXIgPSBhd2FpdCBwcmlzbWEub3JkZXIuZmluZFVuaXF1ZSh7XG4gICAgICB3aGVyZTogeyBpZDogb3JkZXJJZCB9XG4gICAgfSlcblxuICAgIGlmICghZXhpc3RpbmdPcmRlcikge1xuICAgICAgcmV0dXJuIE5leHRSZXNwb25zZS5qc29uKFxuICAgICAgICB7IGVycm9yOiAn0JfQsNC60LDQtyDQvdC1INC90LDQudC00LXQvScgfSxcbiAgICAgICAgeyBzdGF0dXM6IDQwNCB9XG4gICAgICApXG4gICAgfVxuXG4gICAgLy8g0KPQtNCw0LvRj9C10Lwg0LfQsNC60LDQt1xuICAgIGF3YWl0IHByaXNtYS5vcmRlci5kZWxldGUoe1xuICAgICAgd2hlcmU6IHsgaWQ6IG9yZGVySWQgfVxuICAgIH0pXG5cbiAgICAvLyDQntCx0L3QvtCy0LvRj9C10Lwg0YHRh9C10YLRh9C40Log0LfQsNC60LDQt9C+0LIg0LIg0LrQsNGC0LXQs9C+0YDQuNC4XG4gICAgYXdhaXQgcHJpc21hLmNhdGVnb3J5LnVwZGF0ZSh7XG4gICAgICB3aGVyZTogeyBpZDogZXhpc3RpbmdPcmRlci5jYXRlZ29yeUlkIH0sXG4gICAgICBkYXRhOiB7XG4gICAgICAgIG9yZGVyQ291bnQ6IHtcbiAgICAgICAgICBkZWNyZW1lbnQ6IDFcbiAgICAgICAgfVxuICAgICAgfVxuICAgIH0pXG5cbiAgICByZXR1cm4gTmV4dFJlc3BvbnNlLmpzb24oe1xuICAgICAgc3VjY2VzczogdHJ1ZSxcbiAgICAgIG1lc3NhZ2U6ICfQl9Cw0LrQsNC3INGD0YHQv9C10YjQvdC+INGD0LTQsNC70LXQvSdcbiAgICB9KVxuICB9IGNhdGNoIChlcnJvcikge1xuICAgIGNvbnNvbGUuZXJyb3IoJ0Vycm9yIGRlbGV0aW5nIG9yZGVyOicsIGVycm9yKVxuICAgIHJldHVybiBOZXh0UmVzcG9uc2UuanNvbihcbiAgICAgIHsgZXJyb3I6ICfQntGI0LjQsdC60LAg0L/RgNC4INGD0LTQsNC70LXQvdC40Lgg0LfQsNC60LDQt9CwJyB9LFxuICAgICAgeyBzdGF0dXM6IDUwMCB9XG4gICAgKVxuICB9XG59XG4iXSwibmFtZXMiOlsiTmV4dFJlc3BvbnNlIiwiUHJpc21hQ2xpZW50IiwiZ2V0VXNlckRhdGFGcm9tVG9rZW4iLCJWaW9sYXRpb25TeXN0ZW0iLCJwcmlzbWEiLCJHRVQiLCJyZXF1ZXN0IiwicGFyYW1zIiwib3JkZXJJZCIsInBhcnNlSW50IiwiaWQiLCJjb25zb2xlIiwibG9nIiwiYXV0aEhlYWRlciIsImhlYWRlcnMiLCJnZXQiLCJ1c2VyRGF0YSIsInJvbGUiLCJuYW1lIiwianNvbiIsImVycm9yIiwic3RhdHVzIiwib3JkZXIiLCJmaW5kVW5pcXVlIiwid2hlcmUiLCJpbmNsdWRlIiwiY2F0ZWdvcnkiLCJjbGllbnQiLCJzZWxlY3QiLCJlbWFpbCIsInBob25lIiwiY2xpZW50UmF0aW5nIiwiY2xpZW50UmV2aWV3c0NvdW50IiwiZXhlY3V0b3IiLCJjbGllbnRJZCIsImV4ZWN1dG9ySWQiLCJleGVjdXRvclByb2ZpbGUiLCJ1c2VySWQiLCJjYXRlZ29yaWVzIiwiaW5jbHVkZXMiLCJjYXRlZ29yeUlkIiwiUEFUQ0giLCJib2R5IiwiZXhpc3RpbmdPcmRlciIsImJsb2NrU3RhdHVzIiwiaXNFeGVjdXRvckJsb2NrZWQiLCJpc0Jsb2NrZWQiLCJyZWFzb24iLCJibG9ja0VuZERhdGUiLCJoYXNBY3RpdmVTdWJzY3JpcHRpb24iLCJzdWJzY3JpcHRpb24iLCJmaW5kRmlyc3QiLCJlbmREYXRlIiwiZ3RlIiwiRGF0ZSIsInN1YnNjcmlwdGlvblJlcXVpcmVkIiwidXBkYXRlZE9yZGVyIiwidXBkYXRlIiwiZGF0YSIsIm5vdGlmaWNhdGlvbiIsImNyZWF0ZSIsInRpdGxlIiwibWVzc2FnZSIsInNlcnZpY2VEZXNjcmlwdGlvbiIsInR5cGUiLCJjb21wbGV0ZWRBdCIsImNvbXBsZXRlZE9yZGVycyIsImluY3JlbWVudCIsImNhbmNlbGxlZEF0IiwiREVMRVRFIiwiZGVsZXRlIiwib3JkZXJDb3VudCIsImRlY3JlbWVudCIsInN1Y2Nlc3MiXSwic291cmNlUm9vdCI6IiJ9\n//# sourceURL=webpack-internal:///(rsc)/./app/api/orders/[id]/route.ts\n");

/***/ }),

/***/ "(rsc)/./lib/serverUtils.ts":
/*!****************************!*\
  !*** ./lib/serverUtils.ts ***!
  \****************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   getUserDataFromToken: () => (/* binding */ getUserDataFromToken),\n/* harmony export */   safeBase64Decode: () => (/* binding */ safeBase64Decode)\n/* harmony export */ });\n/* harmony import */ var buffer__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! buffer */ \"buffer\");\n/* harmony import */ var buffer__WEBPACK_IMPORTED_MODULE_0___default = /*#__PURE__*/__webpack_require__.n(buffer__WEBPACK_IMPORTED_MODULE_0__);\n\n// Безопасное декодирование из base64 для UTF-8 строк на сервере\nfunction safeBase64Decode(str) {\n    try {\n        // Сначала декодируем из base64, затем из UTF-8\n        return buffer__WEBPACK_IMPORTED_MODULE_0__.Buffer.from(str, \"base64\").toString(\"utf-8\");\n    } catch (error) {\n        console.error(\"Error decoding from base64:\", error);\n        // Fallback: используем простой Buffer для ASCII строк\n        return buffer__WEBPACK_IMPORTED_MODULE_0__.Buffer.from(str, \"base64\").toString(\"ascii\");\n    }\n}\n// Извлечение данных пользователя из токена авторизации\nfunction getUserDataFromToken(authHeader) {\n    if (!authHeader) {\n        return null;\n    }\n    try {\n        const token = authHeader.replace(\"Bearer \", \"\");\n        const userDataString = safeBase64Decode(token);\n        return JSON.parse(userDataString);\n    } catch (error) {\n        console.error(\"Error parsing user data from token:\", error);\n        return null;\n    }\n}\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKHJzYykvLi9saWIvc2VydmVyVXRpbHMudHMiLCJtYXBwaW5ncyI6Ijs7Ozs7OztBQUErQjtBQUUvQixnRUFBZ0U7QUFDekQsU0FBU0MsaUJBQWlCQyxHQUFXO0lBQzFDLElBQUk7UUFDRiwrQ0FBK0M7UUFDL0MsT0FBT0YsMENBQU1BLENBQUNHLElBQUksQ0FBQ0QsS0FBSyxVQUFVRSxRQUFRLENBQUM7SUFDN0MsRUFBRSxPQUFPQyxPQUFPO1FBQ2RDLFFBQVFELEtBQUssQ0FBQywrQkFBK0JBO1FBQzdDLHNEQUFzRDtRQUN0RCxPQUFPTCwwQ0FBTUEsQ0FBQ0csSUFBSSxDQUFDRCxLQUFLLFVBQVVFLFFBQVEsQ0FBQztJQUM3QztBQUNGO0FBRUEsdURBQXVEO0FBQ2hELFNBQVNHLHFCQUFxQkMsVUFBeUI7SUFDNUQsSUFBSSxDQUFDQSxZQUFZO1FBQ2YsT0FBTztJQUNUO0lBRUEsSUFBSTtRQUNGLE1BQU1DLFFBQVFELFdBQVdFLE9BQU8sQ0FBQyxXQUFXO1FBQzVDLE1BQU1DLGlCQUFpQlYsaUJBQWlCUTtRQUN4QyxPQUFPRyxLQUFLQyxLQUFLLENBQUNGO0lBQ3BCLEVBQUUsT0FBT04sT0FBTztRQUNkQyxRQUFRRCxLQUFLLENBQUMsdUNBQXVDQTtRQUNyRCxPQUFPO0lBQ1Q7QUFDRiIsInNvdXJjZXMiOlsid2VicGFjazovL3Byb2RvLWFnZW5jeS8uL2xpYi9zZXJ2ZXJVdGlscy50cz85YWViIl0sInNvdXJjZXNDb250ZW50IjpbImltcG9ydCB7IEJ1ZmZlciB9IGZyb20gJ2J1ZmZlcidcclxuXHJcbi8vINCR0LXQt9C+0L/QsNGB0L3QvtC1INC00LXQutC+0LTQuNGA0L7QstCw0L3QuNC1INC40LcgYmFzZTY0INC00LvRjyBVVEYtOCDRgdGC0YDQvtC6INC90LAg0YHQtdGA0LLQtdGA0LVcclxuZXhwb3J0IGZ1bmN0aW9uIHNhZmVCYXNlNjREZWNvZGUoc3RyOiBzdHJpbmcpOiBzdHJpbmcge1xyXG4gIHRyeSB7XHJcbiAgICAvLyDQodC90LDRh9Cw0LvQsCDQtNC10LrQvtC00LjRgNGD0LXQvCDQuNC3IGJhc2U2NCwg0LfQsNGC0LXQvCDQuNC3IFVURi04XHJcbiAgICByZXR1cm4gQnVmZmVyLmZyb20oc3RyLCAnYmFzZTY0JykudG9TdHJpbmcoJ3V0Zi04JylcclxuICB9IGNhdGNoIChlcnJvcikge1xyXG4gICAgY29uc29sZS5lcnJvcignRXJyb3IgZGVjb2RpbmcgZnJvbSBiYXNlNjQ6JywgZXJyb3IpXHJcbiAgICAvLyBGYWxsYmFjazog0LjRgdC/0L7Qu9GM0LfRg9C10Lwg0L/RgNC+0YHRgtC+0LkgQnVmZmVyINC00LvRjyBBU0NJSSDRgdGC0YDQvtC6XHJcbiAgICByZXR1cm4gQnVmZmVyLmZyb20oc3RyLCAnYmFzZTY0JykudG9TdHJpbmcoJ2FzY2lpJylcclxuICB9XHJcbn1cclxuXHJcbi8vINCY0LfQstC70LXRh9C10L3QuNC1INC00LDQvdC90YvRhSDQv9C+0LvRjNC30L7QstCw0YLQtdC70Y8g0LjQtyDRgtC+0LrQtdC90LAg0LDQstGC0L7RgNC40LfQsNGG0LjQuFxyXG5leHBvcnQgZnVuY3Rpb24gZ2V0VXNlckRhdGFGcm9tVG9rZW4oYXV0aEhlYWRlcjogc3RyaW5nIHwgbnVsbCkge1xyXG4gIGlmICghYXV0aEhlYWRlcikge1xyXG4gICAgcmV0dXJuIG51bGxcclxuICB9XHJcblxyXG4gIHRyeSB7XHJcbiAgICBjb25zdCB0b2tlbiA9IGF1dGhIZWFkZXIucmVwbGFjZSgnQmVhcmVyICcsICcnKVxyXG4gICAgY29uc3QgdXNlckRhdGFTdHJpbmcgPSBzYWZlQmFzZTY0RGVjb2RlKHRva2VuKVxyXG4gICAgcmV0dXJuIEpTT04ucGFyc2UodXNlckRhdGFTdHJpbmcpXHJcbiAgfSBjYXRjaCAoZXJyb3IpIHtcclxuICAgIGNvbnNvbGUuZXJyb3IoJ0Vycm9yIHBhcnNpbmcgdXNlciBkYXRhIGZyb20gdG9rZW46JywgZXJyb3IpXHJcbiAgICByZXR1cm4gbnVsbFxyXG4gIH1cclxufVxyXG5cclxuXHJcblxyXG5cclxuXHJcblxyXG5cclxuIl0sIm5hbWVzIjpbIkJ1ZmZlciIsInNhZmVCYXNlNjREZWNvZGUiLCJzdHIiLCJmcm9tIiwidG9TdHJpbmciLCJlcnJvciIsImNvbnNvbGUiLCJnZXRVc2VyRGF0YUZyb21Ub2tlbiIsImF1dGhIZWFkZXIiLCJ0b2tlbiIsInJlcGxhY2UiLCJ1c2VyRGF0YVN0cmluZyIsIkpTT04iLCJwYXJzZSJdLCJzb3VyY2VSb290IjoiIn0=\n//# sourceURL=webpack-internal:///(rsc)/./lib/serverUtils.ts\n");

/***/ }),

/***/ "(rsc)/./lib/violationSystem.ts":
/*!********************************!*\
  !*** ./lib/violationSystem.ts ***!
  \********************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   ViolationSystem: () => (/* binding */ ViolationSystem)\n/* harmony export */ });\n/* harmony import */ var _prisma_client__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! @prisma/client */ \"@prisma/client\");\n/* harmony import */ var _prisma_client__WEBPACK_IMPORTED_MODULE_0___default = /*#__PURE__*/__webpack_require__.n(_prisma_client__WEBPACK_IMPORTED_MODULE_0__);\n\nconst prisma = new _prisma_client__WEBPACK_IMPORTED_MODULE_0__.PrismaClient();\nclass ViolationSystem {\n    // Создание нарушения за невыполненный заказ\n    static async recordUncompletedOrder(executorId, orderId, reason) {\n        try {\n            // Получаем информацию об исполнителе\n            const executor = await prisma.user.findUnique({\n                where: {\n                    id: executorId\n                },\n                include: {\n                    violations: {\n                        where: {\n                            type: \"uncompleted_order\",\n                            createdAt: {\n                                gte: new Date(Date.now() - 30 * 24 * 60 * 60 * 1000) // За последние 30 дней\n                            }\n                        },\n                        orderBy: {\n                            createdAt: \"desc\"\n                        }\n                    }\n                }\n            });\n            if (!executor) {\n                return {\n                    success: false,\n                    message: \"Исполнитель не найден\"\n                };\n            }\n            // Создаем запись о нарушении\n            const violation = await prisma.violation.create({\n                data: {\n                    executorId,\n                    orderId,\n                    type: \"uncompleted_order\",\n                    reason: reason || \"Заказ не был выполнен в срок\",\n                    severity: 1\n                }\n            });\n            // Обновляем счетчик нарушений\n            const newViolationsCount = executor.violationsCount + 1;\n            const now = new Date();\n            let blockDuration = 0;\n            let blockEndDate;\n            let blockReason = \"\";\n            // Определяем уровень наказания\n            if (newViolationsCount === 1) {\n                // Первое нарушение - только предупреждение\n                blockReason = \"Предупреждение за невыполненный заказ\";\n            } else if (newViolationsCount === 2) {\n                // Второе нарушение - блокировка на 3 дня\n                blockDuration = 3;\n                blockEndDate = new Date(now.getTime() + 3 * 24 * 60 * 60 * 1000);\n                blockReason = \"Блокировка на 3 дня за повторное невыполнение заказа\";\n            } else if (newViolationsCount === 3) {\n                // Третье нарушение - блокировка на 7 дней\n                blockDuration = 7;\n                blockEndDate = new Date(now.getTime() + 7 * 24 * 60 * 60 * 1000);\n                blockReason = \"Блокировка на 7 дней за систематическое невыполнение заказов\";\n            } else if (newViolationsCount >= 4) {\n                // Четвертое и последующие нарушения - блокировка на 30 дней\n                blockDuration = 30;\n                blockEndDate = new Date(now.getTime() + 30 * 24 * 60 * 60 * 1000);\n                blockReason = \"Блокировка на 30 дней за систематическое невыполнение заказов\";\n            }\n            // Обновляем информацию об исполнителе\n            await prisma.user.update({\n                where: {\n                    id: executorId\n                },\n                data: {\n                    violationsCount: newViolationsCount,\n                    lastViolationDate: now,\n                    isBlocked: blockDuration > 0,\n                    blockStartDate: blockDuration > 0 ? now : null,\n                    blockEndDate: blockEndDate || null,\n                    blockReason: blockReason || null\n                }\n            });\n            // Создаем уведомление для исполнителя\n            await prisma.notification.create({\n                data: {\n                    userId: executorId,\n                    type: \"violation\",\n                    title: blockDuration > 0 ? \"Аккаунт заблокирован\" : \"Предупреждение\",\n                    message: blockReason,\n                    isRead: false\n                }\n            });\n            // Если исполнитель заблокирован, возвращаем заказ в открытый поиск\n            if (blockDuration > 0) {\n                await prisma.order.update({\n                    where: {\n                        id: orderId\n                    },\n                    data: {\n                        status: \"pending\",\n                        executorId: null\n                    }\n                });\n            }\n            return {\n                success: true,\n                message: blockReason,\n                blockDuration,\n                blockEndDate\n            };\n        } catch (error) {\n            console.error(\"Error recording violation:\", error);\n            return {\n                success: false,\n                message: \"Ошибка при записи нарушения\"\n            };\n        }\n    }\n    // Проверка возможности отмены заказа (в течение 12 часов)\n    static async canCancelOrder(executorId, orderId) {\n        try {\n            const order = await prisma.order.findUnique({\n                where: {\n                    id: orderId\n                },\n                include: {\n                    executor: true\n                }\n            });\n            if (!order || order.executorId !== executorId) {\n                return false;\n            }\n            // Проверяем, прошло ли 12 часов с момента принятия заказа\n            const twelveHoursAgo = new Date(Date.now() - 12 * 60 * 60 * 1000);\n            return order.updatedAt > twelveHoursAgo;\n        } catch (error) {\n            console.error(\"Error checking cancellation eligibility:\", error);\n            return false;\n        }\n    }\n    // Отмена заказа исполнителем (в течение 12 часов)\n    static async cancelOrderByExecutor(executorId, orderId, reason) {\n        try {\n            const canCancel = await this.canCancelOrder(executorId, orderId);\n            if (!canCancel) {\n                return {\n                    success: false,\n                    message: \"Отмена заказа возможна только в течение 12 часов после принятия\"\n                };\n            }\n            // Возвращаем заказ в открытый поиск\n            await prisma.order.update({\n                where: {\n                    id: orderId\n                },\n                data: {\n                    status: \"pending\",\n                    executorId: null\n                }\n            });\n            // Создаем уведомление для клиента\n            const order = await prisma.order.findUnique({\n                where: {\n                    id: orderId\n                },\n                include: {\n                    client: true\n                }\n            });\n            if (order) {\n                await prisma.notification.create({\n                    data: {\n                        userId: order.clientId,\n                        type: \"order_cancelled\",\n                        title: \"Заказ отменен исполнителем\",\n                        message: `Исполнитель отменил заказ. ${reason || \"Причина не указана\"}`,\n                        isRead: false\n                    }\n                });\n            }\n            return {\n                success: true,\n                message: \"Заказ успешно отменен и возвращен в открытый поиск\"\n            };\n        } catch (error) {\n            console.error(\"Error cancelling order:\", error);\n            return {\n                success: false,\n                message: \"Ошибка при отмене заказа\"\n            };\n        }\n    }\n    // Проверка блокировки исполнителя\n    static async isExecutorBlocked(executorId) {\n        try {\n            const executor = await prisma.user.findUnique({\n                where: {\n                    id: executorId\n                }\n            });\n            if (!executor) {\n                return {\n                    isBlocked: false\n                };\n            }\n            // Проверяем, истекла ли блокировка\n            if (executor.isBlocked && executor.blockEndDate && executor.blockEndDate <= new Date()) {\n                // Разблокируем исполнителя\n                await prisma.user.update({\n                    where: {\n                        id: executorId\n                    },\n                    data: {\n                        isBlocked: false,\n                        blockStartDate: null,\n                        blockEndDate: null,\n                        blockReason: null\n                    }\n                });\n                return {\n                    isBlocked: false\n                };\n            }\n            return {\n                isBlocked: executor.isBlocked,\n                reason: executor.blockReason || undefined,\n                blockEndDate: executor.blockEndDate || undefined\n            };\n        } catch (error) {\n            console.error(\"Error checking executor block status:\", error);\n            return {\n                isBlocked: false\n            };\n        }\n    }\n    // Получение истории нарушений исполнителя\n    static async getExecutorViolations(executorId) {\n        try {\n            return await prisma.violation.findMany({\n                where: {\n                    executorId\n                },\n                include: {\n                    order: {\n                        select: {\n                            id: true,\n                            serviceDescription: true,\n                            orderDate: true\n                        }\n                    }\n                },\n                orderBy: {\n                    createdAt: \"desc\"\n                }\n            });\n        } catch (error) {\n            console.error(\"Error fetching executor violations:\", error);\n            return [];\n        }\n    }\n}\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,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d0IsTUFBTSxDQUFDO29CQUN2QnRCLE9BQU87d0JBQUVDLElBQUlQO29CQUFXO29CQUN4Qm9CLE1BQU07d0JBQ0pVLFdBQVc7d0JBQ1hDLGdCQUFnQjt3QkFDaEJOLGNBQWM7d0JBQ2RDLGFBQWE7b0JBQ2Y7Z0JBQ0Y7Z0JBRUEsT0FBTztvQkFBRUksV0FBVztnQkFBTTtZQUM1QjtZQUVBLE9BQU87Z0JBQ0xBLFdBQVczQixTQUFTMkIsU0FBUztnQkFDN0I1QixRQUFRQyxTQUFTdUIsV0FBVyxJQUFJc0I7Z0JBQ2hDdkIsY0FBY3RCLFNBQVNzQixZQUFZLElBQUl1QjtZQUN6QztRQUVGLEVBQUUsT0FBT1YsT0FBTztZQUNkQyxRQUFRRCxLQUFLLENBQUMseUNBQXlDQTtZQUN2RCxPQUFPO2dCQUFFUixXQUFXO1lBQU07UUFDNUI7SUFDRjtJQUVBLDBDQUEwQztJQUMxQyxhQUFhbUIsc0JBQXNCakQsVUFBa0IsRUFBRTtRQUNyRCxJQUFJO1lBQ0YsT0FBTyxNQUFNSCxPQUFPcUIsU0FBUyxDQUFDZ0MsUUFBUSxDQUFDO2dCQUNyQzVDLE9BQU87b0JBQUVOO2dCQUFXO2dCQUNwQlEsU0FBUztvQkFDUDRCLE9BQU87d0JBQ0xlLFFBQVE7NEJBQ041QyxJQUFJOzRCQUNKNkMsb0JBQW9COzRCQUNwQkMsV0FBVzt3QkFDYjtvQkFDRjtnQkFDRjtnQkFDQXRDLFNBQVM7b0JBQUVKLFdBQVc7Z0JBQU87WUFDL0I7UUFDRixFQUFFLE9BQU8yQixPQUFPO1lBQ2RDLFFBQVFELEtBQUssQ0FBQyx1Q0FBdUNBO1lBQ3JELE9BQU8sRUFBRTtRQUNYO0lBQ0Y7QUFDRiIsInNvdXJjZXMiOlsid2VicGFjazovL3Byb2RvLWFnZW5jeS8uL2xpYi92aW9sYXRpb25TeXN0ZW0udHM/NTg4YSJdLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgeyBQcmlzbWFDbGllbnQgfSBmcm9tICdAcHJpc21hL2NsaWVudCdcclxuXHJcbmNvbnN0IHByaXNtYSA9IG5ldyBQcmlzbWFDbGllbnQoKVxyXG5cclxuZXhwb3J0IGludGVyZmFjZSBWaW9sYXRpb25SZXN1bHQge1xyXG4gIHN1Y2Nlc3M6IGJvb2xlYW5cclxuICBtZXNzYWdlOiBzdHJpbmdcclxuICBibG9ja0R1cmF0aW9uPzogbnVtYmVyIC8vINCyINC00L3Rj9GFXHJcbiAgYmxvY2tFbmREYXRlPzogRGF0ZVxyXG59XHJcblxyXG5leHBvcnQgY2xhc3MgVmlvbGF0aW9uU3lzdGVtIHtcclxuICAvLyDQodC+0LfQtNCw0L3QuNC1INC90LDRgNGD0YjQtdC90LjRjyDQt9CwINC90LXQstGL0L/QvtC70L3QtdC90L3Ri9C5INC30LDQutCw0LdcclxuICBzdGF0aWMgYXN5bmMgcmVjb3JkVW5jb21wbGV0ZWRPcmRlcihleGVjdXRvcklkOiBudW1iZXIsIG9yZGVySWQ6IG51bWJlciwgcmVhc29uPzogc3RyaW5nKTogUHJvbWlzZTxWaW9sYXRpb25SZXN1bHQ+IHtcclxuICAgIHRyeSB7XHJcbiAgICAgIC8vINCf0L7Qu9GD0YfQsNC10Lwg0LjQvdGE0L7RgNC80LDRhtC40Y4g0L7QsSDQuNGB0L/QvtC70L3QuNGC0LXQu9C1XHJcbiAgICAgIGNvbnN0IGV4ZWN1dG9yID0gYXdhaXQgcHJpc21hLnVzZXIuZmluZFVuaXF1ZSh7XHJcbiAgICAgICAgd2hlcmU6IHsgaWQ6IGV4ZWN1dG9ySWQgfSxcclxuICAgICAgICBpbmNsdWRlOiB7XHJcbiAgICAgICAgICB2aW9sYXRpb25zOiB7XHJcbiAgICAgICAgICAgIHdoZXJlOiB7XHJcbiAgICAgICAgICAgICAgdHlwZTogJ3VuY29tcGxldGVkX29yZGVyJyxcclxuICAgICAgICAgICAgICBjcmVhdGVkQXQ6IHtcclxuICAgICAgICAgICAgICAgIGd0ZTogbmV3IERhdGUoRGF0ZS5ub3coKSAtIDMwICogMjQgKiA2MCAqIDYwICogMTAwMCkgLy8g0JfQsCDQv9C+0YHQu9C10LTQvdC40LUgMzAg0LTQvdC10LlcclxuICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIH0sXHJcbiAgICAgICAgICAgIG9yZGVyQnk6IHsgY3JlYXRlZEF0OiAnZGVzYycgfVxyXG4gICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuICAgICAgfSlcclxuXHJcbiAgICAgIGlmICghZXhlY3V0b3IpIHtcclxuICAgICAgICByZXR1cm4geyBzdWNjZXNzOiBmYWxzZSwgbWVzc2FnZTogJ9CY0YHQv9C+0LvQvdC40YLQtdC70Ywg0L3QtSDQvdCw0LnQtNC10L0nIH1cclxuICAgICAgfVxyXG5cclxuICAgICAgLy8g0KHQvtC30LTQsNC10Lwg0LfQsNC/0LjRgdGMINC+INC90LDRgNGD0YjQtdC90LjQuFxyXG4gICAgICBjb25zdCB2aW9sYXRpb24gPSBhd2FpdCBwcmlzbWEudmlvbGF0aW9uLmNyZWF0ZSh7XHJcbiAgICAgICAgZGF0YToge1xyXG4gICAgICAgICAgZXhlY3V0b3JJZCxcclxuICAgICAgICAgIG9yZGVySWQsXHJcbiAgICAgICAgICB0eXBlOiAndW5jb21wbGV0ZWRfb3JkZXInLFxyXG4gICAgICAgICAgcmVhc29uOiByZWFzb24gfHwgJ9CX0LDQutCw0Lcg0L3QtSDQsdGL0Lsg0LLRi9C/0L7Qu9C90LXQvSDQsiDRgdGA0L7QuicsXHJcbiAgICAgICAgICBzZXZlcml0eTogMVxyXG4gICAgICAgIH1cclxuICAgICAgfSlcclxuXHJcbiAgICAgIC8vINCe0LHQvdC+0LLQu9GP0LXQvCDRgdGH0LXRgtGH0LjQuiDQvdCw0YDRg9GI0LXQvdC40LlcclxuICAgICAgY29uc3QgbmV3VmlvbGF0aW9uc0NvdW50ID0gZXhlY3V0b3IudmlvbGF0aW9uc0NvdW50ICsgMVxyXG4gICAgICBjb25zdCBub3cgPSBuZXcgRGF0ZSgpXHJcblxyXG4gICAgICBsZXQgYmxvY2tEdXJhdGlvbiA9IDBcclxuICAgICAgbGV0IGJsb2NrRW5kRGF0ZTogRGF0ZSB8IHVuZGVmaW5lZFxyXG4gICAgICBsZXQgYmxvY2tSZWFzb24gPSAnJ1xyXG5cclxuICAgICAgLy8g0J7Qv9GA0LXQtNC10LvRj9C10Lwg0YPRgNC+0LLQtdC90Ywg0L3QsNC60LDQt9Cw0L3QuNGPXHJcbiAgICAgIGlmIChuZXdWaW9sYXRpb25zQ291bnQgPT09IDEpIHtcclxuICAgICAgICAvLyDQn9C10YDQstC+0LUg0L3QsNGA0YPRiNC10L3QuNC1IC0g0YLQvtC70YzQutC+INC/0YDQtdC00YPQv9GA0LXQttC00LXQvdC40LVcclxuICAgICAgICBibG9ja1JlYXNvbiA9ICfQn9GA0LXQtNGD0L/RgNC10LbQtNC10L3QuNC1INC30LAg0L3QtdCy0YvQv9C+0LvQvdC10L3QvdGL0Lkg0LfQsNC60LDQtydcclxuICAgICAgfSBlbHNlIGlmIChuZXdWaW9sYXRpb25zQ291bnQgPT09IDIpIHtcclxuICAgICAgICAvLyDQktGC0L7RgNC+0LUg0L3QsNGA0YPRiNC10L3QuNC1IC0g0LHQu9C+0LrQuNGA0L7QstC60LAg0L3QsCAzINC00L3Rj1xyXG4gICAgICAgIGJsb2NrRHVyYXRpb24gPSAzXHJcbiAgICAgICAgYmxvY2tFbmREYXRlID0gbmV3IERhdGUobm93LmdldFRpbWUoKSArIDMgKiAyNCAqIDYwICogNjAgKiAxMDAwKVxyXG4gICAgICAgIGJsb2NrUmVhc29uID0gJ9CR0LvQvtC60LjRgNC+0LLQutCwINC90LAgMyDQtNC90Y8g0LfQsCDQv9C+0LLRgtC+0YDQvdC+0LUg0L3QtdCy0YvQv9C+0LvQvdC10L3QuNC1INC30LDQutCw0LfQsCdcclxuICAgICAgfSBlbHNlIGlmIChuZXdWaW9sYXRpb25zQ291bnQgPT09IDMpIHtcclxuICAgICAgICAvLyDQotGA0LXRgtGM0LUg0L3QsNGA0YPRiNC10L3QuNC1IC0g0LHQu9C+0LrQuNGA0L7QstC60LAg0L3QsCA3INC00L3QtdC5XHJcbiAgICAgICAgYmxvY2tEdXJhdGlvbiA9IDdcclxuICAgICAgICBibG9ja0VuZERhdGUgPSBuZXcgRGF0ZShub3cuZ2V0VGltZSgpICsgNyAqIDI0ICogNjAgKiA2MCAqIDEwMDApXHJcbiAgICAgICAgYmxvY2tSZWFzb24gPSAn0JHQu9C+0LrQuNGA0L7QstC60LAg0L3QsCA3INC00L3QtdC5INC30LAg0YHQuNGB0YLQtdC80LDRgtC40YfQtdGB0LrQvtC1INC90LXQstGL0L/QvtC70L3QtdC90LjQtSDQt9Cw0LrQsNC30L7QsidcclxuICAgICAgfSBlbHNlIGlmIChuZXdWaW9sYXRpb25zQ291bnQgPj0gNCkge1xyXG4gICAgICAgIC8vINCn0LXRgtCy0LXRgNGC0L7QtSDQuCDQv9C+0YHQu9C10LTRg9GO0YnQuNC1INC90LDRgNGD0YjQtdC90LjRjyAtINCx0LvQvtC60LjRgNC+0LLQutCwINC90LAgMzAg0LTQvdC10LlcclxuICAgICAgICBibG9ja0R1cmF0aW9uID0gMzBcclxuICAgICAgICBibG9ja0VuZERhdGUgPSBuZXcgRGF0ZShub3cuZ2V0VGltZSgpICsgMzAgKiAyNCAqIDYwICogNjAgKiAxMDAwKVxyXG4gICAgICAgIGJsb2NrUmVhc29uID0gJ9CR0LvQvtC60LjRgNC+0LLQutCwINC90LAgMzAg0LTQvdC10Lkg0LfQsCDRgdC40YHRgtC10LzQsNGC0LjRh9C10YHQutC+0LUg0L3QtdCy0YvQv9C+0LvQvdC10L3QuNC1INC30LDQutCw0LfQvtCyJ1xyXG4gICAgICB9XHJcblxyXG4gICAgICAvLyDQntCx0L3QvtCy0LvRj9C10Lwg0LjQvdGE0L7RgNC80LDRhtC40Y4g0L7QsSDQuNGB0L/QvtC70L3QuNGC0LXQu9C1XHJcbiAgICAgIGF3YWl0IHByaXNtYS51c2VyLnVwZGF0ZSh7XHJcbiAgICAgICAgd2hlcmU6IHsgaWQ6IGV4ZWN1dG9ySWQgfSxcclxuICAgICAgICBkYXRhOiB7XHJcbiAgICAgICAgICB2aW9sYXRpb25zQ291bnQ6IG5ld1Zpb2xhdGlvbnNDb3VudCxcclxuICAgICAgICAgIGxhc3RWaW9sYXRpb25EYXRlOiBub3csXHJcbiAgICAgICAgICBpc0Jsb2NrZWQ6IGJsb2NrRHVyYXRpb24gPiAwLFxyXG4gICAgICAgICAgYmxvY2tTdGFydERhdGU6IGJsb2NrRHVyYXRpb24gPiAwID8gbm93IDogbnVsbCxcclxuICAgICAgICAgIGJsb2NrRW5kRGF0ZTogYmxvY2tFbmREYXRlIHx8IG51bGwsXHJcbiAgICAgICAgICBibG9ja1JlYXNvbjogYmxvY2tSZWFzb24gfHwgbnVsbFxyXG4gICAgICAgIH1cclxuICAgICAgfSlcclxuXHJcbiAgICAgIC8vINCh0L7Qt9C00LDQtdC8INGD0LLQtdC00L7QvNC70LXQvdC40LUg0LTQu9GPINC40YHQv9C+0LvQvdC40YLQtdC70Y9cclxuICAgICAgYXdhaXQgcHJpc21hLm5vdGlmaWNhdGlvbi5jcmVhdGUoe1xyXG4gICAgICAgIGRhdGE6IHtcclxuICAgICAgICAgIHVzZXJJZDogZXhlY3V0b3JJZCxcclxuICAgICAgICAgIHR5cGU6ICd2aW9sYXRpb24nLFxyXG4gICAgICAgICAgdGl0bGU6IGJsb2NrRHVyYXRpb24gPiAwID8gJ9CQ0LrQutCw0YPQvdGCINC30LDQsdC70L7QutC40YDQvtCy0LDQvScgOiAn0J/RgNC10LTRg9C/0YDQtdC20LTQtdC90LjQtScsXHJcbiAgICAgICAgICBtZXNzYWdlOiBibG9ja1JlYXNvbixcclxuICAgICAgICAgIGlzUmVhZDogZmFsc2VcclxuICAgICAgICB9XHJcbiAgICAgIH0pXHJcblxyXG4gICAgICAvLyDQldGB0LvQuCDQuNGB0L/QvtC70L3QuNGC0LXQu9GMINC30LDQsdC70L7QutC40YDQvtCy0LDQvSwg0LLQvtC30LLRgNCw0YnQsNC10Lwg0LfQsNC60LDQtyDQsiDQvtGC0LrRgNGL0YLRi9C5INC/0L7QuNGB0LpcclxuICAgICAgaWYgKGJsb2NrRHVyYXRpb24gPiAwKSB7XHJcbiAgICAgICAgYXdhaXQgcHJpc21hLm9yZGVyLnVwZGF0ZSh7XHJcbiAgICAgICAgICB3aGVyZTogeyBpZDogb3JkZXJJZCB9LFxyXG4gICAgICAgICAgZGF0YToge1xyXG4gICAgICAgICAgICBzdGF0dXM6ICdwZW5kaW5nJyxcclxuICAgICAgICAgICAgZXhlY3V0b3JJZDogbnVsbFxyXG4gICAgICAgICAgfVxyXG4gICAgICAgIH0pXHJcbiAgICAgIH1cclxuXHJcbiAgICAgIHJldHVybiB7XHJcbiAgICAgICAgc3VjY2VzczogdHJ1ZSxcclxuICAgICAgICBtZXNzYWdlOiBibG9ja1JlYXNvbixcclxuICAgICAgICBibG9ja0R1cmF0aW9uLFxyXG4gICAgICAgIGJsb2NrRW5kRGF0ZVxyXG4gICAgICB9XHJcblxyXG4gICAgfSBjYXRjaCAoZXJyb3IpIHtcclxuICAgICAgY29uc29sZS5lcnJvcignRXJyb3IgcmVjb3JkaW5nIHZpb2xhdGlvbjonLCBlcnJvcilcclxuICAgICAgcmV0dXJuIHsgc3VjY2VzczogZmFsc2UsIG1lc3NhZ2U6ICfQntGI0LjQsdC60LAg0L/RgNC4INC30LDQv9C40YHQuCDQvdCw0YDRg9GI0LXQvdC40Y8nIH1cclxuICAgIH1cclxuICB9XHJcblxyXG4gIC8vINCf0YDQvtCy0LXRgNC60LAg0LLQvtC30LzQvtC20L3QvtGB0YLQuCDQvtGC0LzQtdC90Ysg0LfQsNC60LDQt9CwICjQsiDRgtC10YfQtdC90LjQtSAxMiDRh9Cw0YHQvtCyKVxyXG4gIHN0YXRpYyBhc3luYyBjYW5DYW5jZWxPcmRlcihleGVjdXRvcklkOiBudW1iZXIsIG9yZGVySWQ6IG51bWJlcik6IFByb21pc2U8Ym9vbGVhbj4ge1xyXG4gICAgdHJ5IHtcclxuICAgICAgY29uc3Qgb3JkZXIgPSBhd2FpdCBwcmlzbWEub3JkZXIuZmluZFVuaXF1ZSh7XHJcbiAgICAgICAgd2hlcmU6IHsgaWQ6IG9yZGVySWQgfSxcclxuICAgICAgICBpbmNsdWRlOiB7IGV4ZWN1dG9yOiB0cnVlIH1cclxuICAgICAgfSlcclxuXHJcbiAgICAgIGlmICghb3JkZXIgfHwgb3JkZXIuZXhlY3V0b3JJZCAhPT0gZXhlY3V0b3JJZCkge1xyXG4gICAgICAgIHJldHVybiBmYWxzZVxyXG4gICAgICB9XHJcblxyXG4gICAgICAvLyDQn9GA0L7QstC10YDRj9C10LwsINC/0YDQvtGI0LvQviDQu9C4IDEyINGH0LDRgdC+0LIg0YEg0LzQvtC80LXQvdGC0LAg0L/RgNC40L3Rj9GC0LjRjyDQt9Cw0LrQsNC30LBcclxuICAgICAgY29uc3QgdHdlbHZlSG91cnNBZ28gPSBuZXcgRGF0ZShEYXRlLm5vdygpIC0gMTIgKiA2MCAqIDYwICogMTAwMClcclxuICAgICAgcmV0dXJuIG9yZGVyLnVwZGF0ZWRBdCA+IHR3ZWx2ZUhvdXJzQWdvXHJcblxyXG4gICAgfSBjYXRjaCAoZXJyb3IpIHtcclxuICAgICAgY29uc29sZS5lcnJvcignRXJyb3IgY2hlY2tpbmcgY2FuY2VsbGF0aW9uIGVsaWdpYmlsaXR5OicsIGVycm9yKVxyXG4gICAgICByZXR1cm4gZmFsc2VcclxuICAgIH1cclxuICB9XHJcblxyXG4gIC8vINCe0YLQvNC10L3QsCDQt9Cw0LrQsNC30LAg0LjRgdC/0L7Qu9C90LjRgtC10LvQtdC8ICjQsiDRgtC10YfQtdC90LjQtSAxMiDRh9Cw0YHQvtCyKVxyXG4gIHN0YXRpYyBhc3luYyBjYW5jZWxPcmRlckJ5RXhlY3V0b3IoZXhlY3V0b3JJZDogbnVtYmVyLCBvcmRlcklkOiBudW1iZXIsIHJlYXNvbj86IHN0cmluZyk6IFByb21pc2U8VmlvbGF0aW9uUmVzdWx0PiB7XHJcbiAgICB0cnkge1xyXG4gICAgICBjb25zdCBjYW5DYW5jZWwgPSBhd2FpdCB0aGlzLmNhbkNhbmNlbE9yZGVyKGV4ZWN1dG9ySWQsIG9yZGVySWQpXHJcbiAgICAgIFxyXG4gICAgICBpZiAoIWNhbkNhbmNlbCkge1xyXG4gICAgICAgIHJldHVybiB7IHN1Y2Nlc3M6IGZhbHNlLCBtZXNzYWdlOiAn0J7RgtC80LXQvdCwINC30LDQutCw0LfQsCDQstC+0LfQvNC+0LbQvdCwINGC0L7Qu9GM0LrQviDQsiDRgtC10YfQtdC90LjQtSAxMiDRh9Cw0YHQvtCyINC/0L7RgdC70LUg0L/RgNC40L3Rj9GC0LjRjycgfVxyXG4gICAgICB9XHJcblxyXG4gICAgICAvLyDQktC+0LfQstGA0LDRidCw0LXQvCDQt9Cw0LrQsNC3INCyINC+0YLQutGA0YvRgtGL0Lkg0L/QvtC40YHQulxyXG4gICAgICBhd2FpdCBwcmlzbWEub3JkZXIudXBkYXRlKHtcclxuICAgICAgICB3aGVyZTogeyBpZDogb3JkZXJJZCB9LFxyXG4gICAgICAgIGRhdGE6IHtcclxuICAgICAgICAgIHN0YXR1czogJ3BlbmRpbmcnLFxyXG4gICAgICAgICAgZXhlY3V0b3JJZDogbnVsbFxyXG4gICAgICAgIH1cclxuICAgICAgfSlcclxuXHJcbiAgICAgIC8vINCh0L7Qt9C00LDQtdC8INGD0LLQtdC00L7QvNC70LXQvdC40LUg0LTQu9GPINC60LvQuNC10L3RgtCwXHJcbiAgICAgIGNvbnN0IG9yZGVyID0gYXdhaXQgcHJpc21hLm9yZGVyLmZpbmRVbmlxdWUoe1xyXG4gICAgICAgIHdoZXJlOiB7IGlkOiBvcmRlcklkIH0sXHJcbiAgICAgICAgaW5jbHVkZTogeyBjbGllbnQ6IHRydWUgfVxyXG4gICAgICB9KVxyXG5cclxuICAgICAgaWYgKG9yZGVyKSB7XHJcbiAgICAgICAgYXdhaXQgcHJpc21hLm5vdGlmaWNhdGlvbi5jcmVhdGUoe1xyXG4gICAgICAgICAgZGF0YToge1xyXG4gICAgICAgICAgICB1c2VySWQ6IG9yZGVyLmNsaWVudElkLFxyXG4gICAgICAgICAgICB0eXBlOiAnb3JkZXJfY2FuY2VsbGVkJyxcclxuICAgICAgICAgICAgdGl0bGU6ICfQl9Cw0LrQsNC3INC+0YLQvNC10L3QtdC9INC40YHQv9C+0LvQvdC40YLQtdC70LXQvCcsXHJcbiAgICAgICAgICAgIG1lc3NhZ2U6IGDQmNGB0L/QvtC70L3QuNGC0LXQu9GMINC+0YLQvNC10L3QuNC7INC30LDQutCw0LcuICR7cmVhc29uIHx8ICfQn9GA0LjRh9C40L3QsCDQvdC1INGD0LrQsNC30LDQvdCwJ31gLFxyXG4gICAgICAgICAgICBpc1JlYWQ6IGZhbHNlXHJcbiAgICAgICAgICB9XHJcbiAgICAgICAgfSlcclxuICAgICAgfVxyXG5cclxuICAgICAgcmV0dXJuIHsgc3VjY2VzczogdHJ1ZSwgbWVzc2FnZTogJ9CX0LDQutCw0Lcg0YPRgdC/0LXRiNC90L4g0L7RgtC80LXQvdC10L0g0Lgg0LLQvtC30LLRgNCw0YnQtdC9INCyINC+0YLQutGA0YvRgtGL0Lkg0L/QvtC40YHQuicgfVxyXG5cclxuICAgIH0gY2F0Y2ggKGVycm9yKSB7XHJcbiAgICAgIGNvbnNvbGUuZXJyb3IoJ0Vycm9yIGNhbmNlbGxpbmcgb3JkZXI6JywgZXJyb3IpXHJcbiAgICAgIHJldHVybiB7IHN1Y2Nlc3M6IGZhbHNlLCBtZXNzYWdlOiAn0J7RiNC40LHQutCwINC/0YDQuCDQvtGC0LzQtdC90LUg0LfQsNC60LDQt9CwJyB9XHJcbiAgICB9XHJcbiAgfVxyXG5cclxuICAvLyDQn9GA0L7QstC10YDQutCwINCx0LvQvtC60LjRgNC+0LLQutC4INC40YHQv9C+0LvQvdC40YLQtdC70Y9cclxuICBzdGF0aWMgYXN5bmMgaXNFeGVjdXRvckJsb2NrZWQoZXhlY3V0b3JJZDogbnVtYmVyKTogUHJvbWlzZTx7IGlzQmxvY2tlZDogYm9vbGVhbjsgcmVhc29uPzogc3RyaW5nOyBibG9ja0VuZERhdGU/OiBEYXRlIH0+IHtcclxuICAgIHRyeSB7XHJcbiAgICAgIGNvbnN0IGV4ZWN1dG9yID0gYXdhaXQgcHJpc21hLnVzZXIuZmluZFVuaXF1ZSh7XHJcbiAgICAgICAgd2hlcmU6IHsgaWQ6IGV4ZWN1dG9ySWQgfVxyXG4gICAgICB9KVxyXG5cclxuICAgICAgaWYgKCFleGVjdXRvcikge1xyXG4gICAgICAgIHJldHVybiB7IGlzQmxvY2tlZDogZmFsc2UgfVxyXG4gICAgICB9XHJcblxyXG4gICAgICAvLyDQn9GA0L7QstC10YDRj9C10LwsINC40YHRgtC10LrQu9CwINC70Lgg0LHQu9C+0LrQuNGA0L7QstC60LBcclxuICAgICAgaWYgKGV4ZWN1dG9yLmlzQmxvY2tlZCAmJiBleGVjdXRvci5ibG9ja0VuZERhdGUgJiYgZXhlY3V0b3IuYmxvY2tFbmREYXRlIDw9IG5ldyBEYXRlKCkpIHtcclxuICAgICAgICAvLyDQoNCw0LfQsdC70L7QutC40YDRg9C10Lwg0LjRgdC/0L7Qu9C90LjRgtC10LvRj1xyXG4gICAgICAgIGF3YWl0IHByaXNtYS51c2VyLnVwZGF0ZSh7XHJcbiAgICAgICAgICB3aGVyZTogeyBpZDogZXhlY3V0b3JJZCB9LFxyXG4gICAgICAgICAgZGF0YToge1xyXG4gICAgICAgICAgICBpc0Jsb2NrZWQ6IGZhbHNlLFxyXG4gICAgICAgICAgICBibG9ja1N0YXJ0RGF0ZTogbnVsbCxcclxuICAgICAgICAgICAgYmxvY2tFbmREYXRlOiBudWxsLFxyXG4gICAgICAgICAgICBibG9ja1JlYXNvbjogbnVsbFxyXG4gICAgICAgICAgfVxyXG4gICAgICAgIH0pXHJcblxyXG4gICAgICAgIHJldHVybiB7IGlzQmxvY2tlZDogZmFsc2UgfVxyXG4gICAgICB9XHJcblxyXG4gICAgICByZXR1cm4ge1xyXG4gICAgICAgIGlzQmxvY2tlZDogZXhlY3V0b3IuaXNCbG9ja2VkLFxyXG4gICAgICAgIHJlYXNvbjogZXhlY3V0b3IuYmxvY2tSZWFzb24gfHwgdW5kZWZpbmVkLFxyXG4gICAgICAgIGJsb2NrRW5kRGF0ZTogZXhlY3V0b3IuYmxvY2tFbmREYXRlIHx8IHVuZGVmaW5lZFxyXG4gICAgICB9XHJcblxyXG4gICAgfSBjYXRjaCAoZXJyb3IpIHtcclxuICAgICAgY29uc29sZS5lcnJvcignRXJyb3IgY2hlY2tpbmcgZXhlY3V0b3IgYmxvY2sgc3RhdHVzOicsIGVycm9yKVxyXG4gICAgICByZXR1cm4geyBpc0Jsb2NrZWQ6IGZhbHNlIH1cclxuICAgIH1cclxuICB9XHJcblxyXG4gIC8vINCf0L7Qu9GD0YfQtdC90LjQtSDQuNGB0YLQvtGA0LjQuCDQvdCw0YDRg9GI0LXQvdC40Lkg0LjRgdC/0L7Qu9C90LjRgtC10LvRj1xyXG4gIHN0YXRpYyBhc3luYyBnZXRFeGVjdXRvclZpb2xhdGlvbnMoZXhlY3V0b3JJZDogbnVtYmVyKSB7XHJcbiAgICB0cnkge1xyXG4gICAgICByZXR1cm4gYXdhaXQgcHJpc21hLnZpb2xhdGlvbi5maW5kTWFueSh7XHJcbiAgICAgICAgd2hlcmU6IHsgZXhlY3V0b3JJZCB9LFxyXG4gICAgICAgIGluY2x1ZGU6IHtcclxuICAgICAgICAgIG9yZGVyOiB7XHJcbiAgICAgICAgICAgIHNlbGVjdDoge1xyXG4gICAgICAgICAgICAgIGlkOiB0cnVlLFxyXG4gICAgICAgICAgICAgIHNlcnZpY2VEZXNjcmlwdGlvbjogdHJ1ZSxcclxuICAgICAgICAgICAgICBvcmRlckRhdGU6IHRydWVcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgfVxyXG4gICAgICAgIH0sXHJcbiAgICAgICAgb3JkZXJCeTogeyBjcmVhdGVkQXQ6ICdkZXNjJyB9XHJcbiAgICAgIH0pXHJcbiAgICB9IGNhdGNoIChlcnJvcikge1xyXG4gICAgICBjb25zb2xlLmVycm9yKCdFcnJvciBmZXRjaGluZyBleGVjdXRvciB2aW9sYXRpb25zOicsIGVycm9yKVxyXG4gICAgICByZXR1cm4gW11cclxuICAgIH1cclxuICB9XHJcbn1cclxuXHJcblxyXG4iXSwibmFtZXMiOlsiUHJpc21hQ2xpZW50IiwicHJpc21hIiwiVmlvbGF0aW9uU3lzdGVtIiwicmVjb3JkVW5jb21wbGV0ZWRPcmRlciIsImV4ZWN1dG9ySWQiLCJvcmRlcklkIiwicmVhc29uIiwiZXhlY3V0b3IiLCJ1c2VyIiwiZmluZFVuaXF1ZSIsIndoZXJlIiwiaWQiLCJpbmNsdWRlIiwidmlvbGF0aW9ucyIsInR5cGUiLCJjcmVhdGVkQXQiLCJndGUiLCJEYXRlIiwibm93Iiwib3JkZXJCeSIsInN1Y2Nlc3MiLCJtZXNzYWdlIiwidmlvbGF0aW9uIiwiY3JlYXRlIiwiZGF0YSIsInNldmVyaXR5IiwibmV3VmlvbGF0aW9uc0NvdW50IiwidmlvbGF0aW9uc0NvdW50IiwiYmxvY2tEdXJhdGlvbiIsImJsb2NrRW5kRGF0ZSIsImJsb2NrUmVhc29uIiwiZ2V0VGltZSIsInVwZGF0ZSIsImxhc3RWaW9sYXRpb25EYXRlIiwiaXNCbG9ja2VkIiwiYmxvY2tTdGFydERhdGUiLCJub3RpZmljYXRpb24iLCJ1c2VySWQiLCJ0aXRsZSIsImlzUmVhZCIsIm9yZGVyIiwic3RhdHVzIiwiZXJyb3IiLCJjb25zb2xlIiwiY2FuQ2FuY2VsT3JkZXIiLCJ0d2VsdmVIb3Vyc0FnbyIsInVwZGF0ZWRBdCIsImNhbmNlbE9yZGVyQnlFeGVjdXRvciIsImNhbkNhbmNlbCIsImNsaWVudCIsImNsaWVudElkIiwiaXNFeGVjdXRvckJsb2NrZWQiLCJ1bmRlZmluZWQiLCJnZXRFeGVjdXRvclZpb2xhdGlvbnMiLCJmaW5kTWFueSIsInNlbGVjdCIsInNlcnZpY2VEZXNjcmlwdGlvbiIsIm9yZGVyRGF0ZSJdLCJzb3VyY2VSb290IjoiIn0=\n//# sourceURL=webpack-internal:///(rsc)/./lib/violationSystem.ts\n");

/***/ })

};
;

// load runtime
var __webpack_require__ = require("../../../../webpack-runtime.js");
__webpack_require__.C(exports);
var __webpack_exec__ = (moduleId) => (__webpack_require__(__webpack_require__.s = moduleId))
var __webpack_exports__ = __webpack_require__.X(0, ["vendor-chunks/next"], () => (__webpack_exec__("(rsc)/./node_modules/next/dist/build/webpack/loaders/next-app-loader.js?name=app%2Fapi%2Forders%2F%5Bid%5D%2Froute&page=%2Fapi%2Forders%2F%5Bid%5D%2Froute&appPaths=&pagePath=private-next-app-dir%2Fapi%2Forders%2F%5Bid%5D%2Froute.ts&appDir=D%3A%5Cmobile%5Capp&pageExtensions=tsx&pageExtensions=ts&pageExtensions=jsx&pageExtensions=js&rootDir=D%3A%5Cmobile&isDev=true&tsconfigPath=tsconfig.json&basePath=&assetPrefix=&nextConfigOutput=&preferredRegion=&middlewareConfig=e30%3D!")));
module.exports = __webpack_exports__;

})();